<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zhehao Hu">
<meta name="dcterms.date" content="2024-09-15">

<title>Niche Overlap Analysis using stable isotope data and nicheROVER – Zhehao Hu</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../site_libs/quarto-contrib/nutshell-1.0.7/nutshell.js"></script>
<script src="../../site_libs/quarto-contrib/nutshell-1.0.7/nutshell_options.js"></script>
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-R0FB3TL998"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-R0FB3TL998', { 'anonymize_ip': true});
</script>
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theme/global.css">
<link rel="stylesheet" href="../../theme/text-justify.css">
<link rel="stylesheet" href="../../theme/caption-center.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Zhehao Hu</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-photography" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Photography</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-photography">    
        <li>
    <a class="dropdown-item" href="../../gallery/gallery.html">
 <span class="dropdown-text">Albums</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/motion-pictures.html">
 <span class="dropdown-text">Motion Picture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../photography/color_palette.html">
 <span class="dropdown-text">Color palette</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Research</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research">    
        <li>
    <a class="dropdown-item" href="../../biology-research/index.html">
 <span class="dropdown-text">Posts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../biology-research/asbiologist.html">
 <span class="dropdown-text">As a Biology Student</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-personal" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Personal</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-personal">    
        <li>
    <a class="dropdown-item" href="../../personal/aboutme.html">
 <span class="dropdown-text">About Me</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../news.html"> 
<span class="menu-text">What’s new</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/zzzhehao" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
    <a href="https://instagram.com/zhehao.hu_" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-instagram"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#niche-overlap" id="toc-niche-overlap" class="nav-link active" data-scroll-target="#niche-overlap">Niche Overlap</a></li>
  <li><a href="#nicherover" id="toc-nicherover" class="nav-link" data-scroll-target="#nicherover"><code>nicheROVER</code></a></li>
  <li><a href="#what-is-sia" id="toc-what-is-sia" class="nav-link" data-scroll-target="#what-is-sia">What is SIA?</a></li>
  <li><a href="#bayesian-workflow" id="toc-bayesian-workflow" class="nav-link" data-scroll-target="#bayesian-workflow">Bayesian Workflow</a>
  <ul>
  <li><a href="#bayesian-theorem" id="toc-bayesian-theorem" class="nav-link" data-scroll-target="#bayesian-theorem">Bayesian theorem</a></li>
  <li><a href="#why-bayesian-statistics" id="toc-why-bayesian-statistics" class="nav-link" data-scroll-target="#why-bayesian-statistics">Why Bayesian Statistics?</a></li>
  <li><a href="#random-vector-and-multivariate-normal-distribution" id="toc-random-vector-and-multivariate-normal-distribution" class="nav-link" data-scroll-target="#random-vector-and-multivariate-normal-distribution">Random Vector and Multivariate Normal Distribution</a></li>
  <li><a href="#covariance-and-covariance-matrix" id="toc-covariance-and-covariance-matrix" class="nav-link" data-scroll-target="#covariance-and-covariance-matrix">Covariance and covariance matrix</a></li>
  <li><a href="#conjugate-prior" id="toc-conjugate-prior" class="nav-link" data-scroll-target="#conjugate-prior">Conjugate Prior</a></li>
  </ul></li>
  <li><a href="#monte-carlo-with-niw.post" id="toc-monte-carlo-with-niw.post" class="nav-link" data-scroll-target="#monte-carlo-with-niw.post">Monte Carlo with <code>niw.post()</code></a></li>
  <li><a href="#niche-parameters" id="toc-niche-parameters" class="nav-link" data-scroll-target="#niche-parameters">Niche Parameters</a></li>
  <li><a href="#d-ellipse-projection" id="toc-d-ellipse-projection" class="nav-link" data-scroll-target="#d-ellipse-projection">2-D Ellipse Projection</a></li>
  <li><a href="#estimate-niche-overlap" id="toc-estimate-niche-overlap" class="nav-link" data-scroll-target="#estimate-niche-overlap">Estimate Niche Overlap</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Niche Overlap Analysis using stable isotope data and nicheROVER</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Ecology</div>
    <div class="quarto-category">Community Ecology</div>
    <div class="quarto-category">Data Analysis</div>
    <div class="quarto-category">Multivariate Analysis</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://zzzhehao.github.io">Zhehao Hu</a> <a href="mailto:zheaho.hu@uni-hamburg.de" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.biologie.uni-hamburg.de/en.html">
            Department of Biology, University of Hamburg
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 15, 2024</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    Stable isotope analysis (SIA) provides numerous information while assessing species’ ecological niche, the R package <em>nicheROVER</em> offers an insightful analysis using stable isotope data.
  </div>
</div>


</header>


<div class="disclaimer">
<p>Part of this note is taken from the course <em>Community Ecology</em> offered by <a href="https://www.biologie.uni-hamburg.de/en.html" target="_blank">University of Hamburg</a> for M.Sc. Biology program and led by <a href="https://www.researchgate.net/profile/Paula-Eterovick-2" target="_blank">Dr.&nbsp;Paula Cabral Eterovick</a>.</p>
<p>The cover image is credited to <a href="https://unsplash.com/photos/silver-and-yellow-fish-on-brown-wooden-table-vlmb9C2Ah_s" target="_blank">Europeana on Unsplash</a>.</p>
</div>
<p><br></p>
<section id="niche-overlap" class="level2">
<h2 class="anchored" data-anchor-id="niche-overlap">Niche Overlap</h2>
<p>In my previous note, <a href="../../biology-research/community-ecology/Ecological-Niche.html" target="_blank">Ecological Niche</a>, we talked about the basic ideas about the ecological niche and niche overlap. Understanding the niche overlap pattern, both intraspecific and interspecific, can help us obtain more insight into many topics, such as:</p>
<p>Evolutionary:</p>
<ul>
<li><strong>Sexual Dimorphism</strong> by study difference in resource utilizing between males and females of the same species.</li>
<li><strong>Speciation Process</strong> by study niche partitioning between sister taxa or subspecies.</li>
</ul>
<p>Conservation:</p>
<ul>
<li><strong>Impact of the Invasive Species</strong> by looking at the niche overlap between native and invasive species.</li>
<li><strong>Ecological Guild</strong> by understanding niche overlap within a group sharing same or similar functional trait (e.g.&nbsp;pollinator communities).</li>
</ul>
<p>However, comparing niches among multiple species is challenging, as I mentioned already, since the ecological data are almost always multidimensional.</p>
</section>
<section id="nicherover" class="level2">
<h2 class="anchored" data-anchor-id="nicherover"><code>nicheROVER</code></h2>
<p>The package <code>nicheROVER</code> provides a new probabilistic method for quantifying n-dimensional ecological niche and niche overlap <span class="citation" data-cites="swanson2015">(<a href="#ref-swanson2015" role="doc-biblioref">Swanson et al. 2015</a>)</span>. The script demonstrated here is written by Martin Lysy, Heidi Swanson (see <a href="https://cran.r-project.org/web/packages/nicheROVER/vignettes/ecol-vignette.html" target="_blank">here</a>), also used in the publication for the method demonstration.</p>
<p><code>fish</code> is a <strong>fish stable isotope dataset</strong> coming along in the package, containing values for three stable isotopes (N-15, C-13, S-34) measured in the muscle tissue of four arctic fish species (ARCS, BDWF, LKWF, LSCS), more details can be found from the documentation (<code>?fish</code>) or in the publication.</p>
<div class="cell">
<div id="tbl-fish" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fish-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: <code>fish</code> dataset
</figcaption>
<div aria-describedby="tbl-fish-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["species"],"name":[1],"type":["fct"],"align":["left"]},{"label":["D15N"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["D13C"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["D34S"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"ARCS","2":"12.18","3":"-23.89","4":"13.07"},{"1":"ARCS","2":"11.19","3":"-23.79","4":"13.77"},{"1":"ARCS","2":"12.05","3":"-22.88","4":"14.03"},{"1":"ARCS","2":"11.25","3":"-24.98","4":"14.18"},{"1":"ARCS","2":"12.08","3":"-25.82","4":"11.84"},{"1":"ARCS","2":"11.54","3":"-25.69","4":"11.23"},{"1":"ARCS","2":"12.64","3":"-22.72","4":"12.46"},{"1":"ARCS","2":"11.25","3":"-24.79","4":"14.62"},{"1":"ARCS","2":"10.94","3":"-26.99","4":"11.26"},{"1":"ARCS","2":"13.18","3":"-22.47","4":"11.74"},{"1":"ARCS","2":"12.60","3":"-24.45","4":"14.44"},{"1":"ARCS","2":"11.14","3":"-24.05","4":"14.63"},{"1":"ARCS","2":"11.48","3":"-24.34","4":"13.92"},{"1":"ARCS","2":"12.97","3":"-24.66","4":"12.75"},{"1":"ARCS","2":"11.95","3":"-22.51","4":"14.16"},{"1":"ARCS","2":"12.49","3":"-23.17","4":"14.37"},{"1":"ARCS","2":"13.30","3":"-24.66","4":"14.57"},{"1":"ARCS","2":"13.46","3":"-22.89","4":"14.87"},{"1":"ARCS","2":"12.57","3":"-22.42","4":"15.06"},{"1":"ARCS","2":"12.81","3":"-23.65","4":"15.14"},{"1":"ARCS","2":"12.89","3":"-22.78","4":"14.76"},{"1":"ARCS","2":"12.79","3":"-24.46","4":"15.27"},{"1":"ARCS","2":"13.33","3":"-22.35","4":"13.50"},{"1":"ARCS","2":"12.37","3":"-22.87","4":"15.82"},{"1":"ARCS","2":"11.27","3":"-25.21","4":"15.08"},{"1":"ARCS","2":"11.42","3":"-24.24","4":"14.16"},{"1":"ARCS","2":"14.40","3":"-23.19","4":"13.83"},{"1":"ARCS","2":"12.95","3":"-22.76","4":"15.60"},{"1":"ARCS","2":"12.62","3":"-22.80","4":"15.50"},{"1":"ARCS","2":"13.25","3":"-23.15","4":"15.85"},{"1":"ARCS","2":"12.45","3":"-25.04","4":"14.09"},{"1":"ARCS","2":"13.51","3":"-23.09","4":"15.35"},{"1":"ARCS","2":"13.54","3":"-22.95","4":"15.16"},{"1":"ARCS","2":"13.12","3":"-21.72","4":"15.37"},{"1":"ARCS","2":"13.14","3":"-22.46","4":"15.02"},{"1":"ARCS","2":"13.84","3":"-22.84","4":"15.45"},{"1":"ARCS","2":"12.61","3":"-24.41","4":"13.70"},{"1":"ARCS","2":"13.72","3":"-24.99","4":"16.26"},{"1":"ARCS","2":"12.33","3":"-25.51","4":"13.58"},{"1":"ARCS","2":"11.08","3":"-24.42","4":"11.26"},{"1":"ARCS","2":"11.61","3":"-24.45","4":"14.96"},{"1":"ARCS","2":"12.54","3":"-24.11","4":"15.23"},{"1":"ARCS","2":"11.93","3":"-24.24","4":"12.46"},{"1":"ARCS","2":"12.33","3":"-24.08","4":"14.67"},{"1":"ARCS","2":"12.13","3":"-23.83","4":"16.09"},{"1":"ARCS","2":"12.45","3":"-25.02","4":"14.67"},{"1":"ARCS","2":"13.04","3":"-25.66","4":"13.90"},{"1":"ARCS","2":"14.16","3":"-25.05","4":"15.64"},{"1":"ARCS","2":"14.17","3":"-24.56","4":"15.72"},{"1":"ARCS","2":"11.48","3":"-23.73","4":"15.09"},{"1":"ARCS","2":"12.56","3":"-23.26","4":"15.54"},{"1":"ARCS","2":"13.09","3":"-22.97","4":"15.52"},{"1":"ARCS","2":"12.90","3":"-23.45","4":"15.64"},{"1":"ARCS","2":"12.56","3":"-24.96","4":"16.67"},{"1":"ARCS","2":"13.09","3":"-25.67","4":"15.65"},{"1":"ARCS","2":"13.42","3":"-23.83","4":"15.53"},{"1":"ARCS","2":"12.87","3":"-24.18","4":"15.73"},{"1":"ARCS","2":"13.66","3":"-22.00","4":"14.99"},{"1":"ARCS","2":"13.33","3":"-23.97","4":"13.83"},{"1":"ARCS","2":"13.24","3":"-25.02","4":"15.22"},{"1":"ARCS","2":"13.35","3":"-23.69","4":"15.03"},{"1":"ARCS","2":"12.87","3":"-22.96","4":"15.21"},{"1":"ARCS","2":"11.96","3":"-25.78","4":"13.55"},{"1":"ARCS","2":"12.90","3":"-23.76","4":"16.04"},{"1":"ARCS","2":"13.05","3":"-25.54","4":"15.81"},{"1":"ARCS","2":"12.19","3":"-24.39","4":"14.77"},{"1":"ARCS","2":"13.50","3":"-22.93","4":"14.83"},{"1":"ARCS","2":"12.50","3":"-23.79","4":"15.56"},{"1":"ARCS","2":"11.47","3":"-24.86","4":"14.76"},{"1":"BDWF","2":"9.58","3":"-26.63","4":"9.28"},{"1":"BDWF","2":"5.91","3":"-28.75","4":"-9.49"},{"1":"BDWF","2":"9.45","3":"-24.99","4":"-5.09"},{"1":"BDWF","2":"8.13","3":"-24.33","4":"0.12"},{"1":"BDWF","2":"6.21","3":"-25.02","4":"-0.97"},{"1":"BDWF","2":"9.52","3":"-26.29","4":"-1.40"},{"1":"BDWF","2":"8.71","3":"-25.46","4":"-6.61"},{"1":"BDWF","2":"10.02","3":"-27.03","4":"-7.69"},{"1":"BDWF","2":"9.17","3":"-24.57","4":"-14.89"},{"1":"BDWF","2":"7.59","3":"-24.20","4":"2.11"},{"1":"BDWF","2":"9.29","3":"-27.61","4":"3.80"},{"1":"BDWF","2":"9.31","3":"-27.42","4":"-3.52"},{"1":"BDWF","2":"7.48","3":"-28.98","4":"-9.09"},{"1":"BDWF","2":"9.23","3":"-26.85","4":"-4.02"},{"1":"BDWF","2":"9.04","3":"-23.49","4":"-15.69"},{"1":"BDWF","2":"9.60","3":"-32.23","4":"8.04"},{"1":"BDWF","2":"8.04","3":"-29.03","4":"-9.18"},{"1":"BDWF","2":"11.94","3":"-27.14","4":"-9.18"},{"1":"BDWF","2":"10.14","3":"-27.50","4":"3.18"},{"1":"BDWF","2":"9.23","3":"-24.67","4":"-14.49"},{"1":"BDWF","2":"9.10","3":"-27.16","4":"6.39"},{"1":"BDWF","2":"10.11","3":"-25.78","4":"-18.00"},{"1":"BDWF","2":"8.69","3":"-23.28","4":"3.39"},{"1":"BDWF","2":"9.42","3":"-24.07","4":"5.45"},{"1":"BDWF","2":"9.26","3":"-29.24","4":"10.04"},{"1":"BDWF","2":"10.03","3":"-25.32","4":"3.74"},{"1":"BDWF","2":"10.61","3":"-27.24","4":"4.82"},{"1":"BDWF","2":"9.70","3":"-27.52","4":"-16.05"},{"1":"BDWF","2":"9.76","3":"-25.05","4":"4.60"},{"1":"BDWF","2":"9.43","3":"-23.47","4":"6.13"},{"1":"BDWF","2":"8.04","3":"-23.54","4":"4.47"},{"1":"BDWF","2":"8.71","3":"-29.20","4":"10.82"},{"1":"BDWF","2":"7.57","3":"-22.65","4":"2.17"},{"1":"BDWF","2":"9.36","3":"-31.02","4":"6.43"},{"1":"BDWF","2":"9.27","3":"-26.67","4":"-20.16"},{"1":"BDWF","2":"9.53","3":"-28.10","4":"-20.05"},{"1":"BDWF","2":"9.26","3":"-23.62","4":"7.59"},{"1":"BDWF","2":"10.19","3":"-25.92","4":"6.54"},{"1":"BDWF","2":"9.60","3":"-29.12","4":"-10.52"},{"1":"BDWF","2":"9.81","3":"-26.80","4":"8.37"},{"1":"BDWF","2":"9.82","3":"-28.85","4":"8.95"},{"1":"BDWF","2":"9.31","3":"-26.82","4":"-11.87"},{"1":"BDWF","2":"9.15","3":"-27.45","4":"9.28"},{"1":"BDWF","2":"9.47","3":"-29.74","4":"9.15"},{"1":"BDWF","2":"9.44","3":"-28.88","4":"-21.24"},{"1":"BDWF","2":"10.60","3":"-27.41","4":"-7.61"},{"1":"BDWF","2":"9.57","3":"-29.03","4":"-15.66"},{"1":"BDWF","2":"9.24","3":"-24.61","4":"5.66"},{"1":"BDWF","2":"9.65","3":"-27.50","4":"0.57"},{"1":"BDWF","2":"9.19","3":"-22.95","4":"4.14"},{"1":"BDWF","2":"8.33","3":"-27.97","4":"-0.73"},{"1":"BDWF","2":"9.52","3":"-26.59","4":"-16.20"},{"1":"BDWF","2":"9.13","3":"-26.89","4":"-15.92"},{"1":"BDWF","2":"9.20","3":"-26.21","4":"-1.98"},{"1":"BDWF","2":"9.57","3":"-27.58","4":"-8.05"},{"1":"BDWF","2":"5.99","3":"-27.77","4":"-0.26"},{"1":"BDWF","2":"6.29","3":"-24.07","4":"-5.81"},{"1":"BDWF","2":"9.49","3":"-27.91","4":"3.36"},{"1":"BDWF","2":"9.21","3":"-27.66","4":"-18.19"},{"1":"BDWF","2":"10.30","3":"-25.08","4":"2.51"},{"1":"BDWF","2":"9.50","3":"-28.18","4":"-15.03"},{"1":"BDWF","2":"10.98","3":"-27.71","4":"2.99"},{"1":"BDWF","2":"9.64","3":"-29.04","4":"9.29"},{"1":"BDWF","2":"9.14","3":"-23.94","4":"3.53"},{"1":"BDWF","2":"10.19","3":"-27.34","4":"-13.14"},{"1":"BDWF","2":"10.02","3":"-28.06","4":"-12.39"},{"1":"BDWF","2":"9.12","3":"-28.63","4":"-6.97"},{"1":"BDWF","2":"9.61","3":"-26.75","4":"-14.54"},{"1":"BDWF","2":"9.44","3":"-26.90","4":"-20.08"},{"1":"BDWF","2":"9.83","3":"-26.89","4":"-16.19"},{"1":"BDWF","2":"13.21","3":"-24.58","4":"17.43"},{"1":"LKWF","2":"12.51","3":"-26.03","4":"1.10"},{"1":"LKWF","2":"11.72","3":"-28.68","4":"8.28"},{"1":"LKWF","2":"12.32","3":"-26.35","4":"5.55"},{"1":"LKWF","2":"11.52","3":"-26.45","4":"-2.20"},{"1":"LKWF","2":"11.45","3":"-26.42","4":"4.83"},{"1":"LKWF","2":"9.49","3":"-25.62","4":"-7.52"},{"1":"LKWF","2":"11.87","3":"-26.02","4":"0.50"},{"1":"LKWF","2":"13.62","3":"-23.92","4":"10.87"},{"1":"LKWF","2":"11.51","3":"-27.26","4":"-9.42"},{"1":"LKWF","2":"10.92","3":"-25.05","4":"6.74"},{"1":"LKWF","2":"11.46","3":"-24.96","4":"7.37"},{"1":"LKWF","2":"10.66","3":"-26.51","4":"6.21"},{"1":"LKWF","2":"11.45","3":"-26.72","4":"6.40"},{"1":"LKWF","2":"10.13","3":"-25.55","4":"1.30"},{"1":"LKWF","2":"10.12","3":"-26.87","4":"3.51"},{"1":"LKWF","2":"10.88","3":"-25.80","4":"8.25"},{"1":"LKWF","2":"12.60","3":"-26.16","4":"7.06"},{"1":"LKWF","2":"10.88","3":"-27.95","4":"7.85"},{"1":"LKWF","2":"11.92","3":"-24.24","4":"3.24"},{"1":"LKWF","2":"10.63","3":"-24.51","4":"6.22"},{"1":"LKWF","2":"9.87","3":"-28.23","4":"-0.91"},{"1":"LKWF","2":"10.94","3":"-25.65","4":"7.15"},{"1":"LKWF","2":"11.64","3":"-23.93","4":"5.12"},{"1":"LKWF","2":"10.96","3":"-24.09","4":"8.00"},{"1":"LKWF","2":"10.66","3":"-25.65","4":"7.16"},{"1":"LKWF","2":"12.08","3":"-23.06","4":"10.90"},{"1":"LKWF","2":"11.14","3":"-26.81","4":"-1.70"},{"1":"LKWF","2":"10.84","3":"-28.79","4":"3.85"},{"1":"LKWF","2":"12.10","3":"-25.20","4":"9.61"},{"1":"LKWF","2":"11.25","3":"-23.80","4":"8.65"},{"1":"LKWF","2":"11.42","3":"-25.13","4":"7.91"},{"1":"LKWF","2":"11.57","3":"-25.22","4":"9.75"},{"1":"LKWF","2":"10.59","3":"-25.24","4":"6.53"},{"1":"LKWF","2":"11.36","3":"-22.62","4":"11.10"},{"1":"LKWF","2":"12.83","3":"-23.66","4":"10.19"},{"1":"LKWF","2":"11.21","3":"-25.20","4":"5.87"},{"1":"LKWF","2":"9.64","3":"-26.05","4":"4.02"},{"1":"LKWF","2":"12.71","3":"-25.96","4":"-0.11"},{"1":"LKWF","2":"10.15","3":"-24.78","4":"2.65"},{"1":"LKWF","2":"10.08","3":"-24.29","4":"7.67"},{"1":"LKWF","2":"10.16","3":"-21.57","4":"9.33"},{"1":"LKWF","2":"10.97","3":"-23.72","4":"13.56"},{"1":"LKWF","2":"10.70","3":"-25.81","4":"-0.76"},{"1":"LKWF","2":"10.73","3":"-24.80","4":"8.11"},{"1":"LKWF","2":"11.57","3":"-24.10","4":"10.64"},{"1":"LKWF","2":"9.53","3":"-23.51","4":"9.37"},{"1":"LKWF","2":"12.70","3":"-25.74","4":"10.97"},{"1":"LKWF","2":"10.70","3":"-24.01","4":"10.01"},{"1":"LKWF","2":"11.63","3":"-24.78","4":"8.10"},{"1":"LKWF","2":"11.24","3":"-24.43","4":"12.64"},{"1":"LKWF","2":"11.09","3":"-23.14","4":"8.24"},{"1":"LKWF","2":"12.01","3":"-22.59","4":"13.66"},{"1":"LKWF","2":"10.55","3":"-26.06","4":"8.12"},{"1":"LKWF","2":"9.53","3":"-26.62","4":"-5.72"},{"1":"LKWF","2":"9.56","3":"-28.15","4":"6.59"},{"1":"LKWF","2":"11.50","3":"-24.65","4":"6.67"},{"1":"LKWF","2":"11.45","3":"-24.00","4":"10.61"},{"1":"LKWF","2":"11.24","3":"-23.81","4":"8.11"},{"1":"LKWF","2":"10.04","3":"-23.16","4":"8.62"},{"1":"LKWF","2":"10.22","3":"-24.15","4":"9.00"},{"1":"LKWF","2":"9.88","3":"-23.43","4":"6.85"},{"1":"LKWF","2":"10.34","3":"-25.55","4":"8.16"},{"1":"LKWF","2":"10.58","3":"-25.21","4":"0.73"},{"1":"LKWF","2":"10.56","3":"-24.25","4":"10.48"},{"1":"LKWF","2":"9.91","3":"-24.95","4":"2.78"},{"1":"LKWF","2":"10.66","3":"-25.31","4":"2.49"},{"1":"LKWF","2":"9.69","3":"-23.32","4":"11.89"},{"1":"LSCS","2":"11.50","3":"-26.15","4":"14.97"},{"1":"LSCS","2":"11.46","3":"-26.71","4":"9.54"},{"1":"LSCS","2":"11.29","3":"-25.46","4":"6.13"},{"1":"LSCS","2":"12.08","3":"-24.98","4":"11.13"},{"1":"LSCS","2":"11.90","3":"-26.84","4":"11.93"},{"1":"LSCS","2":"9.41","3":"-24.92","4":"9.16"},{"1":"LSCS","2":"11.87","3":"-27.04","4":"0.87"},{"1":"LSCS","2":"10.71","3":"-26.04","4":"8.46"},{"1":"LSCS","2":"12.14","3":"-25.46","4":"0.21"},{"1":"LSCS","2":"11.14","3":"-25.32","4":"11.29"},{"1":"LSCS","2":"11.45","3":"-25.26","4":"10.16"},{"1":"LSCS","2":"11.87","3":"-27.40","4":"7.26"},{"1":"LSCS","2":"11.06","3":"-26.56","4":"5.49"},{"1":"LSCS","2":"10.16","3":"-25.58","4":"9.82"},{"1":"LSCS","2":"11.64","3":"-29.50","4":"11.27"},{"1":"LSCS","2":"11.64","3":"-25.56","4":"14.93"},{"1":"LSCS","2":"12.82","3":"-24.37","4":"5.99"},{"1":"LSCS","2":"10.85","3":"-26.43","4":"13.74"},{"1":"LSCS","2":"11.28","3":"-25.74","4":"3.88"},{"1":"LSCS","2":"12.77","3":"-24.32","4":"12.16"},{"1":"LSCS","2":"12.52","3":"-25.19","4":"14.42"},{"1":"LSCS","2":"12.09","3":"-27.17","4":"13.05"},{"1":"LSCS","2":"11.14","3":"-25.22","4":"10.82"},{"1":"LSCS","2":"11.45","3":"-24.46","4":"11.05"},{"1":"LSCS","2":"12.36","3":"-23.84","4":"12.35"},{"1":"LSCS","2":"10.94","3":"-25.12","4":"12.15"},{"1":"LSCS","2":"11.29","3":"-26.18","4":"10.88"},{"1":"LSCS","2":"10.90","3":"-24.22","4":"12.86"},{"1":"LSCS","2":"12.41","3":"-25.40","4":"2.86"},{"1":"LSCS","2":"10.91","3":"-25.76","4":"12.13"},{"1":"LSCS","2":"11.64","3":"-26.65","4":"8.86"},{"1":"LSCS","2":"12.50","3":"-24.22","4":"13.95"},{"1":"LSCS","2":"11.98","3":"-26.30","4":"10.56"},{"1":"LSCS","2":"13.30","3":"-24.72","4":"14.45"},{"1":"LSCS","2":"12.82","3":"-24.21","4":"13.41"},{"1":"LSCS","2":"11.65","3":"-27.55","4":"13.34"},{"1":"LSCS","2":"11.71","3":"-25.34","4":"11.46"},{"1":"LSCS","2":"11.92","3":"-25.47","4":"11.50"},{"1":"LSCS","2":"11.92","3":"-25.86","4":"6.60"},{"1":"LSCS","2":"11.88","3":"-25.63","4":"11.65"},{"1":"LSCS","2":"12.14","3":"-24.82","4":"12.18"},{"1":"LSCS","2":"12.13","3":"-24.42","4":"14.22"},{"1":"LSCS","2":"12.08","3":"-24.40","4":"14.62"},{"1":"LSCS","2":"10.71","3":"-24.81","4":"12.48"},{"1":"LSCS","2":"11.81","3":"-23.93","4":"15.07"},{"1":"LSCS","2":"11.12","3":"-24.42","4":"12.69"},{"1":"LSCS","2":"11.77","3":"-27.25","4":"7.53"},{"1":"LSCS","2":"12.60","3":"-25.97","4":"10.91"},{"1":"LSCS","2":"11.95","3":"-25.58","4":"10.80"},{"1":"LSCS","2":"11.74","3":"-24.37","4":"14.06"},{"1":"LSCS","2":"11.58","3":"-24.30","4":"14.47"},{"1":"LSCS","2":"10.62","3":"-23.91","4":"11.76"},{"1":"LSCS","2":"11.72","3":"-23.94","4":"13.94"},{"1":"LSCS","2":"10.96","3":"-23.90","4":"13.85"},{"1":"LSCS","2":"11.77","3":"-24.85","4":"12.85"},{"1":"LSCS","2":"11.68","3":"-24.06","4":"14.85"},{"1":"LSCS","2":"12.75","3":"-23.95","4":"13.98"},{"1":"LSCS","2":"11.30","3":"-24.62","4":"12.66"},{"1":"LSCS","2":"11.02","3":"-24.63","4":"10.67"},{"1":"LSCS","2":"13.32","3":"-23.28","4":"13.91"},{"1":"LSCS","2":"13.54","3":"-23.24","4":"14.34"},{"1":"LSCS","2":"11.63","3":"-23.82","4":"13.59"},{"1":"LSCS","2":"11.87","3":"-23.75","4":"15.20"},{"1":"LSCS","2":"11.44","3":"-23.43","4":"14.35"},{"1":"LSCS","2":"11.24","3":"-23.96","4":"14.87"},{"1":"LSCS","2":"11.96","3":"-23.20","4":"13.03"},{"1":"LSCS","2":"10.91","3":"-23.99","4":"12.49"},{"1":"LSCS","2":"12.94","3":"-24.42","4":"17.90"},{"1":"LSCS","2":"11.78","3":"-26.57","4":"10.32"},{"1":"LSCS","2":"12.02","3":"-24.89","4":"11.27"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="what-is-sia" class="level2">
<h2 class="anchored" data-anchor-id="what-is-sia">What is SIA?</h2>
<p><strong>Stable isotope analysis (SIA)</strong> is a powerful tool in ecological niche analysis. Many physicochemical and biochemical processes are sensitive to differences in the dissociation energies of molecules, which often depend on the mass of the elements from which these molecules are made. Thus, the isotopic composition of many materials (expressed as <span class="math inline">\(\delta\)</span>-values), including the tissues of organisms, often contains a label of the process that created it <span class="citation" data-cites="newsome2007a">(<a href="#ref-newsome2007a" role="doc-biblioref">Newsome et al. 2007</a>)</span>. These “signatures” provides detailed insights into their ecological roles and interactions.</p>
<div id="tbl-SIAs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-SIAs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: A few common isotope systems and expected patterns in <span class="math inline">\(\delta\)</span>-values, subsetted from <span class="citation" data-cites="newsome2007a">(<a href="#ref-newsome2007a" role="doc-biblioref">Newsome et al. 2007</a>)</span>
</figcaption>
<div aria-describedby="tbl-SIAs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 29%">
<col style="width: 39%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Gradient</th>
<th>Isotope system</th>
<th>High <span class="math inline">\(\delta\)</span>-values</th>
<th>Low <span class="math inline">\(\delta\)</span>-values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Trophic level</td>
<td><span class="math inline">\(\delta ^{13} C\)</span>/<span class="math inline">\(\delta ^{15} N\)</span></td>
<td>High levels</td>
<td>Low levels</td>
</tr>
<tr class="even">
<td>C<sub>3</sub>-C<sub>4</sub> Vegetation</td>
<td><span class="math inline">\(\delta ^{13} C\)</span></td>
<td>C<sub>4</sub> plants</td>
<td>C<sub>3</sub> plants</td>
</tr>
<tr class="odd">
<td>Marine-terrestrial</td>
<td><span class="math inline">\(\delta ^{15} N\)</span>/<span class="math inline">\(\delta ^{13} C\)</span>/<span class="math inline">\(\delta ^{34} S\)</span></td>
<td>High levels</td>
<td>Low levels</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p><br></p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" style="border-left: none; border: 1px solid var(--clcolor);">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="cl-sub">For more information about isotopic and atomic ecology</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><span class="citation" data-cites="newsome2007a">Newsome et al. (<a href="#ref-newsome2007a" role="doc-biblioref">2007</a>)</span></li>
<li><span class="citation" data-cites="michel2021">Michel (<a href="#ref-michel2021" role="doc-biblioref">2021</a>)</span></li>
<li><span class="citation" data-cites="moyo2021">Moyo et al. (<a href="#ref-moyo2021" role="doc-biblioref">2021</a>)</span></li>
<li><span class="citation" data-cites="2024"><span>“Atomic <span>Ecology</span> - <span>Analyzing Stable Isotope Data</span>”</span> (<a href="#ref-2024" role="doc-biblioref">2024</a>)</span></li>
</ul>
</div>
</div>
</div>
</section>
<section id="bayesian-workflow" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="bayesian-workflow">Bayesian Workflow</h2>
<section id="bayesian-theorem" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-theorem">Bayesian theorem</h3>
<p><span class="citation" data-cites="vandeschoot2021">van de Schoot et al. (<a href="#ref-vandeschoot2021" role="doc-biblioref">2021</a>)</span> described the very foundation idea of the Bayesian statistics as following:</p>
<p>Bayesian statistics is an approach to data analysis based on Bayes’ theorem, where available knowledge about parameters in a statistical model is updated with the information in observed data. The background knowledge is expressed as a <strong>prior</strong> distribution and combined with observational data in the form of a likelihood function to determine the <strong>posterior distribution</strong>.</p>
<p>That means, we make an initial estimation of our parameters (prior distribution), we observe data and update the model (posterior distribution).</p>
<p>The Bayesian statistics is based on the <strong>Bayes’ theorem</strong>, which is mathematically stated as following:</p>
<p><span class="math display">\[
P(A|B)=\frac{P(B|A)P(A)}{P(B)}
\]</span></p>
<p>where,</p>
<ul>
<li><span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are events and <span class="math inline">\(P(B)\neq 0\)</span>,</li>
<li><span class="math inline">\(P(A|B)\)</span>: the probability of event <span class="math inline">\(A\)</span> occurring given that <span class="math inline">\(B\)</span> is true. It is also called the <strong>posterior probability</strong> (briefly <em>posterior</em>) of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span>.</li>
<li><span class="math inline">\(P(B|A)\)</span> is also a conditional probability: the probability of event&nbsp;<span class="math inline">\(B\)</span> occurring given that&nbsp;<span class="math inline">\(A\)</span> is true. It can also be interpreted as the likelihood of <span class="math inline">\(A\)</span> given a fixed <span class="math inline">\(B\)</span> because <span class="math inline">\(P(B|A)=L(A|B)\)</span>. (<span class="math inline">\(L\)</span>: likelihood function)</li>
<li><span class="math inline">\(P(A)\)</span> and <span class="math inline">\(P(B)\)</span> are the probabilities of observing <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> respectively without any given conditions; they are known as the <strong>prior probability</strong> and marginal probability.</li>
</ul>
</section>
<section id="why-bayesian-statistics" class="level3">
<h3 class="anchored" data-anchor-id="why-bayesian-statistics">Why Bayesian Statistics?</h3>
<p>Bayesian statistics is a whole other framework and approach on statistical analysis by putting the Bayes’ theorem at the center. Both classical and Bayesian inference, while trying to modelling data, have advantages and disadvantages of each. Bayesian inference is generally employed whenever uncertainty comes to play:</p>
<div class="mini">
<p>There is also a practical advantage of the Bayesian approach, which is that all its inferences are probabilistic and thus can be represented by random simulations. For this reason, whenever we want to summarize uncertainty in estimation beyond simple confidence intervals, and whenever we want to use regression models for predictions, we go Bayesian.</p>
<p>― <span class="citation" data-cites="gelman2024">Gelman, Hill, and Vehtari (<a href="#ref-gelman2024" role="doc-biblioref">2024</a>)</span>, P. 16</p>
</div>
<p><span class="citation" data-cites="swanson2015">Swanson et al. (<a href="#ref-swanson2015" role="doc-biblioref">2015</a>)</span> pointed out a viewpoint from the traditional niche overlap analysis that might introduce problems: geometric approach doesn’t account for uncertainty, and also lacks of direction. It is very well illustrated by Fig. 1 in the publication:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://esajournals.onlinelibrary.wiley.com/cms/asset/d9181a57-fa40-4f4a-9197-460929dad9f8/ecy2015962318-fig-0001-m.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Comparison between geometric and probabilistic isotope overlap metrics. Isotope x is distributed in species A and B (x-axis); dashed lines show means. The 95% niche region (solid lines) of B is completely contained within that of A, such that the geometric overlap of B onto A is 100%. However, the probability that a randomly chosen member from A falls into the isotopic niche of B is only 35%. [@swanson2015]"><img src="https://esajournals.onlinelibrary.wiley.com/cms/asset/d9181a57-fa40-4f4a-9197-460929dad9f8/ecy2015962318-fig-0001-m.jpg" class="img-fluid figure-img" alt="Comparison between geometric and probabilistic isotope overlap metrics. Isotope x is distributed in species A and B (x-axis); dashed lines show means. The 95% niche region (solid lines) of B is completely contained within that of A, such that the geometric overlap of B onto A is 100%. However, the probability that a randomly chosen member from A falls into the isotopic niche of B is only 35%. (Swanson et al. 2015)"></a></p>
<figcaption>Comparison between geometric and probabilistic isotope overlap metrics. Isotope x is distributed in species A and B (x-axis); dashed lines show means. The 95% niche region (solid lines) of B is completely contained within that of A, such that the geometric overlap of B onto A is 100%. However, the probability that a randomly chosen member from A falls into the isotopic niche of B is only 35%. <span class="citation" data-cites="swanson2015">(<a href="#ref-swanson2015" role="doc-biblioref">Swanson et al. 2015</a>)</span></figcaption>
</figure>
</div>
<p>By inviting the variance of the niche probability distribution, not only the mean, it now also differentiates the overlap in directions, which means the probability of a species A falling into species B is not equal to one of that species B falling into species A. And since this perspective starts to consider the probability in the models, a Bayesian workflow will provide more reliable and robust analysis.</p>
</section>
<section id="random-vector-and-multivariate-normal-distribution" class="level3">
<h3 class="anchored" data-anchor-id="random-vector-and-multivariate-normal-distribution">Random Vector and Multivariate Normal Distribution</h3>
<p>Given an individual statistical unit, in our case, the niche described by three isotope ratios, a random vector is a group of variables that describes this mathematical system. Which is again, in our case, those three values of the isotope ratio. The distribution of each component of the random vector together forms a <strong>multivariate distribution</strong>.</p>
<p>When dealing with univariate (one-dimensional) analysis, we often assume that the variable is normally distributed. We do things likewise even with multivariate analysis. The <strong>multivariate normal distribution</strong> is a generalization of the univariate normal distribution into higher dimensions, but it’s not as simple as all components of the random vector being normal. It also requires every linear combination of arbitrary two components in the system being normally distributed (bivariate normal distribution), which is not always true even every single variable is normal on their own. And here comes the covariance matrix into play. Normal distribution is described by two variables, mean and standard deviation (sd), in which the latter being simply the square root of the variance.</p>
</section>
<section id="covariance-and-covariance-matrix" class="level3">
<h3 class="anchored" data-anchor-id="covariance-and-covariance-matrix">Covariance and covariance matrix</h3>
<p><strong>Covariance</strong> is a measure of the joint variability of two variables, the sign of the covariance shows the tendency, i.e.&nbsp;one of the three possible linear relationships between two variables, which are:</p>
<ul>
<li>negative linear relationship, covariance is &lt; 0</li>
<li>no linear relationship, covariance is around 0</li>
<li>positive linear relationship, covariance is &gt; 0</li>
</ul>
<p>The variance is a special case of the covariance in which the two variables are identical. The covariance itself is sensitive to the scale of the data, and it does not provide information of in what extent the two variables correlate with each other and how well the linear correlation fits the data. All these characteristics make covariance difficult to interpret, but it has become an important step stone for many interesting subsequent analysis, such as PCA, correlation analysis, etc.</p>
<p>A <strong>covariance matrix</strong> is a square matrix giving the covariance between each pair of elements, which is always symmetric, and the diagonal elements present the variance of each variable. The covariance matrix describe the joint behavior of every linear combination of two variables, analogue to univariate normal distribution, the covariance and the mean are used to described a multivariate normal distribution.</p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" style="border-left: none; border: 1px solid var(--clcolor);">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="cl-sub">For more information about covariance</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://www.youtube.com/watch?v=qtaqvPAeEJY" target="_blank">StatQuest</a> on YouTube (simply and clearly explained)</li>
</ul>
</div>
</div>
</div>
</section>
<section id="conjugate-prior" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="conjugate-prior">Conjugate Prior</h3>
<p><span class="citation" data-cites="jackson2011">Jackson et al. (<a href="#ref-jackson2011" role="doc-biblioref">2011</a>)</span> suggested that the normal distribution is generally appropriate when dealing with stable isotope ratio, and this gives us a way to simplify the analysis by taking advantage of the <strong>conjugate prior</strong>.</p>
<p>A conjungate prior is a certain prior distribution, that when applied on certain likelihood function, the posterior distribution will also be in the same distribution family. Such as in univaraite analysis, a normal prior and a normal likelihood function results a normal posterior. In our case, the conjugate prior for the multivariate normal is the normal-inverse-wishart (NIW) distribution. It can be considered in two parts: the mean is following a normal distribution and the covariance is following an inverse-Wishart distribution. NIW is commonly used as the prior distribution when modeling a multivariate normal, but the mean and the covariances are unknown.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>The probability of a random observation of a isotope ratio (<span class="math inline">\(x\)</span>) belongs to species <span class="math inline">\(s\)</span> is following a normal distribution.</p>
<p><span class="math display">\[
P(x |\text{species}=s) \backsim N(\mu_s \, , \Sigma_s)
\]</span></p>
</div></div></section>
</section>
<section id="monte-carlo-with-niw.post" class="level2">
<h2 class="anchored" data-anchor-id="monte-carlo-with-niw.post">Monte Carlo with <code>niw.post()</code></h2>
<p>All prior knowledge we just went through, from basic Bayesian inference to the NIW distribution, is to understand the very two lines of code that implemented the Bayesian workflow into the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>nsamples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>fish.par <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fish), fish<span class="sc">$</span>species,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(ii) <span class="fu">niw.post</span>(<span class="at">nsamples =</span> nsamples, <span class="at">X =</span> fish[ii,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>niw.post()</code> uses a data matrix (<code>X</code>) as observation data, calculate the posterior distribution and then draws a set of means and covariance matrix of a possible multivariate distribution, which includes the prior and our observation data. The main idea is that because analytically working with posterior multivariate distribution is too impractical, so we employ the <a href="https://www.youtube.com/watch?v=7ESK5SaP-bc" target="_blank">:Monte Carlo approach</a> to have a view of the posterior. We use <code>tapply()</code> to separately apply 1000 times of <code>niw.post()</code> on each fish species.</p>
<p>This results a list of 4 lists (species) of 2 matrix (mu and Sigma), where the mu matrix has a dimension of 1000 (sampling times) x 3 (number of variables), and the Sigma matrix has a dimension of 1000 (sampling times) x 3 x 3 (one slice = one covariance matrix).</p>
<p>This particular data structure is critical for later application of <code>niche.par.plot()</code>, see <code>?nichr.par.plot</code> for more.</p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" style="font-sze:0.9rem; border-left: none; border: 1px solid var(--clcolor);">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="cl-sub">See the result</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fish.par)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ ARCS:List of 2
  ..$ mu   : num [1:1000, 1:3] 12.8 12.5 12.6 12.5 12.6 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:3] "D15N" "D13C" "D34S"
  ..$ Sigma: num [1:3, 1:3, 1:1000] 1.046 0.379 0.501 0.379 1.326 ...
  .. ..- attr(*, "dimnames")=List of 3
  .. .. ..$ : chr [1:3] "D15N" "D13C" "D34S"
  .. .. ..$ : chr [1:3] "D15N" "D13C" "D34S"
  .. .. ..$ : NULL
 $ BDWF:List of 2
  ..$ mu   : num [1:1000, 1:3] 9.35 9.36 9.51 9.46 9.29 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:3] "D15N" "D13C" "D34S"
  ..$ Sigma: num [1:3, 1:3, 1:1000] 1.7362 -0.0428 1.0549 -0.0428 4.3857 ...
  .. ..- attr(*, "dimnames")=List of 3
  .. .. ..$ : chr [1:3] "D15N" "D13C" "D34S"
  .. .. ..$ : chr [1:3] "D15N" "D13C" "D34S"
  .. .. ..$ : NULL
 $ LKWF:List of 2
  ..$ mu   : num [1:1000, 1:3] 11.1 11.1 11.1 11 11.1 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:3] "D15N" "D13C" "D34S"
  ..$ Sigma: num [1:3, 1:3, 1:1000] 1.048 -0.293 -0.382 -0.293 2.768 ...
  .. ..- attr(*, "dimnames")=List of 3
  .. .. ..$ : chr [1:3] "D15N" "D13C" "D34S"
  .. .. ..$ : chr [1:3] "D15N" "D13C" "D34S"
  .. .. ..$ : NULL
 $ LSCS:List of 2
  ..$ mu   : num [1:1000, 1:3] 11.6 11.8 11.6 11.8 11.7 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:3] "D15N" "D13C" "D34S"
  ..$ Sigma: num [1:3, 1:3, 1:1000] 0.418 0.126 0.332 0.126 1.151 ...
  .. ..- attr(*, "dimnames")=List of 3
  .. .. ..$ : chr [1:3] "D15N" "D13C" "D34S"
  .. .. ..$ : chr [1:3] "D15N" "D13C" "D34S"
  .. .. ..$ : NULL
 - attr(*, "dim")= int 4
 - attr(*, "dimnames")=List of 1
  ..$ : chr [1:4] "ARCS" "BDWF" "LKWF" "LSCS"</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="niche-parameters" class="level2">
<h2 class="anchored" data-anchor-id="niche-parameters">Niche Parameters</h2>
<p><code>niche.par.plot()</code> allows us to have a overview on Monte Carlo simulation of the posterior multivariate distribution of our <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\Sigma\)</span>. It shows the probability density curve of each variable. Use <code>plot.index</code>, <code>plot.mu</code> or <code>plot.Sigma</code> to select which <span class="math inline">\(\mu\)</span> or <span class="math inline">\(\Sigma\)</span> to plot, or simply use <code>plot.mu = TRUE, plot.Sigma = TRUE</code> to display all. See details in the document.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>clrs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#348E8C'</span>, <span class="st">'#732C02'</span>, <span class="st">'#BF0404'</span>, <span class="st">'#F29F05'</span>) <span class="co"># colors for each species</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mu1 (del15N), mu2 (del13C), and Sigma12 </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">1</span>)<span class="sc">+</span>.<span class="dv">1</span>, <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">pty=</span><span class="st">"s"</span>, <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">niche.par.plot</span>(fish.par, <span class="at">col =</span> clrs, <span class="at">plot.index =</span> <span class="dv">1</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">niche.par.plot</span>(fish.par, <span class="at">col =</span> clrs, <span class="at">plot.index =</span> <span class="dv">2</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">niche.par.plot</span>(fish.par, <span class="at">col =</span> clrs, <span class="at">plot.index =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">names</span>(fish.par), <span class="at">fill =</span> clrs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="2_nicheROVER-_Niche_Overlap_Analysis_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="The distribution of \mu_1 (\delta^{15}N) and \mu_2 (\delta^{13}C), as well as the \Sigma_{12} is displayed here."><img src="2_nicheROVER-_Niche_Overlap_Analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672" alt="The distribution of \mu_1 (\delta^{15}N) and \mu_2 (\delta^{13}C), as well as the \Sigma_{12} is displayed here."></a></p>
</figure>
</div>
<figcaption>The distribution of <span class="math inline">\(\mu_1\)</span> (<span class="math inline">\(\delta^{15}N)\)</span> and <span class="math inline">\(\mu_2\)</span> (<span class="math inline">\(\delta^{13}C)\)</span>, as well as the <span class="math inline">\(\Sigma_{12}\)</span> is displayed here.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="d-ellipse-projection" class="level2">
<h2 class="anchored" data-anchor-id="d-ellipse-projection">2-D Ellipse Projection</h2>
<p>To dealing with n-dimensional niche region (N<sub>R</sub>), <span class="citation" data-cites="swanson2015">Swanson et al. (<a href="#ref-swanson2015" role="doc-biblioref">2015</a>)</span> reduced them into 2-dimensional space using probabilistic projection, which is to differentiate from geometric projection. A 2-dimensional probabilistic projection of an n-dimensional N<sub>R</sub> is simply the N<sub>R</sub> calculated by the projected 2 axes <span class="citation" data-cites="jackson2011 swanson2015">(<a href="#ref-jackson2011" role="doc-biblioref">Jackson et al. 2011</a>; <a href="#ref-swanson2015" role="doc-biblioref">Swanson et al. 2015</a>)</span>. Fig. 2 from <span class="citation" data-cites="swanson2015">Swanson et al. (<a href="#ref-swanson2015" role="doc-biblioref">2015</a>)</span> clearly demonstrate and explained the different outcome.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://esajournals.onlinelibrary.wiley.com/cms/asset/91c8eaef-f65e-4f7c-9eb7-b491b568943e/ecy2015962318-fig-0002-m.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="A three-dimensional 95% niche region for normally distributed isotopes. The two ellipses are projections of the niche region (NR) onto isotope axes U and V. The black, hatched ellipse is the geometric projection of NR onto this plane, which is the shadow obtained by shining a light onto the three-dimensional ellipsoid along the W-axis (in blue). This is the largest of the two-dimensional ellipse “slices” taken parallel to the UV-plane. The red ellipse is the 95% niche region constructed directly from isotopes U and V. Thus, the geometric projection of the ellipsoid covers less than 95% of randomly selected individuals in two-dimensional isotope space. [@swanson2015]"><img src="https://esajournals.onlinelibrary.wiley.com/cms/asset/91c8eaef-f65e-4f7c-9eb7-b491b568943e/ecy2015962318-fig-0002-m.gif" class="img-fluid figure-img" alt="A three-dimensional 95% niche region for normally distributed isotopes. The two ellipses are projections of the niche region (NR) onto isotope axes U and V. The black, hatched ellipse is the geometric projection of NR onto this plane, which is the shadow obtained by shining a light onto the three-dimensional ellipsoid along the W-axis (in blue). This is the largest of the two-dimensional ellipse “slices” taken parallel to the UV-plane. The red ellipse is the 95% niche region constructed directly from isotopes U and V. Thus, the geometric projection of the ellipsoid covers less than 95% of randomly selected individuals in two-dimensional isotope space. (Swanson et al. 2015)"></a></p>
<figcaption>A three-dimensional 95% niche region for normally distributed isotopes. The two ellipses are projections of the niche region (NR) onto isotope axes U and V. The black, hatched ellipse is the geometric projection of NR onto this plane, which is the shadow obtained by shining a light onto the three-dimensional ellipsoid along the W-axis (in blue). This is the largest of the two-dimensional ellipse “slices” taken parallel to the UV-plane. The red ellipse is the 95% niche region constructed directly from isotopes U and V. Thus, the geometric projection of the ellipsoid covers less than 95% of randomly selected individuals in two-dimensional isotope space. <span class="citation" data-cites="swanson2015">(<a href="#ref-swanson2015" role="doc-biblioref">Swanson et al. 2015</a>)</span></figcaption>
</figure>
</div>
<p>For the sake of clearness, we only use 10 simulations here. <code>niche.plot()</code> generates three types of plot:</p>
<ol type="1">
<li>Univariate distribution density curves, i.e.&nbsp;smoothed histogram.</li>
<li>Bivariate scatter plots.</li>
<li>2-D projection of N<sub>R</sub> by using simulation data, displayed in ellipse plots.</li>
</ol>
<p>From the first two plot types, we could confirmed the assumption that the isotope ratios are generally normal. While the ellipse plots give us a better view of each species’ N<sub>R</sub> and the overlap situation.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>nsamples <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fish.par <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fish), fish<span class="sc">$</span>species,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(ii) <span class="fu">niw.post</span>(<span class="at">nsamples =</span> nsamples, <span class="at">X =</span> fish[ii,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># format data for plotting function</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>fish.data <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fish), fish<span class="sc">$</span>species, <span class="cf">function</span>(ii) <span class="at">X =</span> fish[ii,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">niche.plot</span>(<span class="at">niche.par =</span> fish.par, <span class="at">niche.data =</span> fish.data, <span class="at">pfrac =</span> .<span class="dv">05</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">iso.names =</span> <span class="fu">expression</span>(delta<span class="sc">^</span>{<span class="dv">15</span>}<span class="sc">*</span>N, delta<span class="sc">^</span>{<span class="dv">13</span>}<span class="sc">*</span>C, delta<span class="sc">^</span>{<span class="dv">34</span>}<span class="sc">*</span>S),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> clrs, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Isotope Ratio (per mil)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="2_nicheROVER-_Niche_Overlap_Analysis_files/figure-html/niche.plot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="2_nicheROVER-_Niche_Overlap_Analysis_files/figure-html/niche.plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a></p>
</figure>
</div>
</div>
</div>
<p>It’s a bit overwhelming plot. Take time to understand it.</p>
</section>
<section id="estimate-niche-overlap" class="level2">
<h2 class="anchored" data-anchor-id="estimate-niche-overlap">Estimate Niche Overlap</h2>
<p>With <code>overlap()</code> we can have a more accurate and robust inference of overlapping among the species, the accuracy of the estimation can be improved by increasing <code>nprob</code>. Generated plot shows pairwise niche overlaps (now we have directions!), which displays the probability distribution of species A (along rows) fallen inside the niche of species B (along columns), with indication of the mean and confidence interval (95% in the show case).</p>
<p>Be careful not to confuse two 95% here - one means that we use 95% of the niche region to calculate overlap, which is specified in <code>overlap()</code> with <code>alpha = 0.95</code>; the other is the 95% credible interval of the probability distribution displayed in each plot. There is difference to spot between plots using 95% or 99% of the niche region.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>nsamples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fish.par <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fish), fish<span class="sc">$</span>species,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(ii) <span class="fu">niw.post</span>(<span class="at">nsamples =</span> nsamples, <span class="at">X =</span> fish[ii,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% niche region</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>over.stat95 <span class="ot">&lt;-</span> <span class="fu">overlap</span>(fish.par, <span class="at">nreps =</span> nsamples, <span class="at">nprob =</span> <span class="dv">1000</span>, <span class="at">alpha =</span> <span class="fl">0.95</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">overlap.plot</span>(over.stat95, <span class="at">col =</span> clrs, <span class="at">mean.cred.col =</span> <span class="st">"#024873"</span>, <span class="at">equal.axis =</span> <span class="cn">TRUE</span>, <span class="at">xlab =</span> <span class="st">"Overlap Probability (%) -- Niche Region Size: 95%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="2_nicheROVER-_Niche_Overlap_Analysis_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="2_nicheROVER-_Niche_Overlap_Analysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 99% niche region</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>over.stat99 <span class="ot">&lt;-</span> <span class="fu">overlap</span>(fish.par, <span class="at">nreps =</span> nsamples, <span class="at">nprob =</span> <span class="dv">1000</span>, <span class="at">alpha =</span> <span class="fl">0.99</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">overlap.plot</span>(over.stat99, <span class="at">col =</span> clrs, <span class="at">mean.cred.col =</span> <span class="st">"#024873"</span>, <span class="at">equal.axis =</span> <span class="cn">TRUE</span>, <span class="at">xlab =</span> <span class="st">"Overlap Probability (%) -- Niche Region Size: 99%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="2_nicheROVER-_Niche_Overlap_Analysis_files/figure-html/unnamed-chunk-9-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="2_nicheROVER-_Niche_Overlap_Analysis_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>By printing out the returned value from <code>overlap()</code>, numeric result can also be showed.</p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" style="font-sze:0.9rem; border-left: none; border: 1px solid var(--clcolor);">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="cl-sub">See detailed results</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We could calculate the estimation for both alpha = 0.99 and 0.95 at the same time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>over.stat<span class="fl">.2</span>lvl <span class="ot">&lt;-</span> <span class="fu">overlap</span>(fish.par, <span class="at">nreps =</span> nsamples, <span class="at">nprob =</span> <span class="dv">1000</span>, <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.99</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>over.mean<span class="fl">.2</span>lvl <span class="ot">&lt;-</span> <span class="fu">apply</span>(over.stat<span class="fl">.2</span>lvl, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span>), mean)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Here are the mean of each overlap probability distribution</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(over.mean<span class="fl">.2</span>lvl, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , alpha = 95%

         Species B
Species A  ARCS  BDWF  LKWF  LSCS
     ARCS    NA 10.98 66.08 81.45
     BDWF  0.30    NA 25.80  4.49
     LKWF  7.43 77.94    NA 52.78
     LSCS 37.68 51.67 88.73    NA

, , alpha = 99%

         Species B
Species A  ARCS  BDWF  LKWF  LSCS
     ARCS    NA 32.96 87.36 91.99
     BDWF  0.76    NA 41.16  8.97
     LKWF 11.76 92.07    NA 70.18
     LSCS 50.26 80.21 97.13    NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here are the upper and lower bounds of the 95% credible interval</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>over.cred <span class="ot">&lt;-</span> <span class="fu">apply</span>(over.stat<span class="fl">.2</span>lvl<span class="sc">*</span><span class="dv">100</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span>), quantile, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(over.cred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , Species B = ARCS, alpha = 95%

       Species A
        ARCS BDWF LKWF LSCS
  2.5%    NA    0    4   28
  97.5%   NA    1   13   48

, , Species B = BDWF, alpha = 95%

       Species A
        ARCS BDWF LKWF LSCS
  2.5%     2   NA   59   24
  97.5%   31   NA   93   81

, , Species B = LKWF, alpha = 95%

       Species A
        ARCS BDWF LKWF LSCS
  2.5%    42   17   NA   76
  97.5%   88   36   NA   97

, , Species B = LSCS, alpha = 95%

       Species A
        ARCS BDWF LKWF LSCS
  2.5%    67    2   38   NA
  97.5%   92    9   67   NA

, , Species B = ARCS, alpha = 99%

       Species A
        ARCS BDWF LKWF LSCS
  2.5%    NA    0    6   39
  97.5%   NA    2   19   62

, , Species B = BDWF, alpha = 99%

       Species A
        ARCS BDWF LKWF LSCS
  2.5%     9   NA   79   54
  97.5%   67   NA   99   97

, , Species B = LKWF, alpha = 99%

       Species A
        ARCS BDWF LKWF LSCS
  2.5%    71   28   NA   91
  97.5%   98   55   NA  100

, , Species B = LSCS, alpha = 99%

       Species A
        ARCS BDWF LKWF LSCS
  2.5%    82    4   56   NA
  97.5%   98   16   83   NA</code></pre>
</div>
</div>
</div>
</div>
</div>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-2024" class="csl-entry" role="listitem">
<span>“Atomic <span>Ecology</span> - <span>Analyzing Stable Isotope Data</span>.”</span> 2024. <a href="https://sites.google.com/view/brianhayden/teaching/analyzing-stable-isotope-data">https://sites.google.com/view/brianhayden/teaching/analyzing-stable-isotope-data</a>.
</div>
<div id="ref-gelman2024" class="csl-entry" role="listitem">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2024. <span>“Regression and <span>Other Stories</span> (Corrections up to 26 <span>Oct</span> 2023) <span>Please</span> Do Not Reproduce in Any Form Without Permission,”</span> July. <a href="https://avehtari.github.io/ROS-Examples/">https://avehtari.github.io/ROS-Examples/</a>.
</div>
<div id="ref-jackson2011" class="csl-entry" role="listitem">
Jackson, Andrew L., Richard Inger, Andrew C. Parnell, and Stuart Bearhop. 2011. <span>“Comparing Isotopic Niche Widths Among and Within Communities: <span>SIBER</span> – <span>Stable Isotope Bayesian Ellipses</span> in <span>R</span>.”</span> <em>Journal of Animal Ecology</em> 80 (3): 595–602. <a href="https://doi.org/10.1111/j.1365-2656.2011.01806.x">https://doi.org/10.1111/j.1365-2656.2011.01806.x</a>.
</div>
<div id="ref-michel2021" class="csl-entry" role="listitem">
Michel, Loïc. 2021. <span>“<span>Stable isotopes as descriptors of ecological niches</span>,”</span> December. <a href="https://doi.org/10.5281/zenodo.5765530">https://doi.org/10.5281/zenodo.5765530</a>.
</div>
<div id="ref-moyo2021" class="csl-entry" role="listitem">
Moyo, Sydney, Hayat Bennadji, Danielle Laguaite, Anna A. Pérez-Umphrey, Allison M. Snider, Andrea Bonisoli-Alquati, Jill A. Olin, et al. 2021. <span>“Stable Isotope Analyses Identify Trophic Niche Partitioning Between Sympatric Terrestrial Vertebrates in Coastal Saltmarshes with Differing Oiling Histories.”</span> <em>PeerJ</em> 9 (July): e11392. <a href="https://doi.org/10.7717/peerj.11392">https://doi.org/10.7717/peerj.11392</a>.
</div>
<div id="ref-newsome2007a" class="csl-entry" role="listitem">
Newsome, Seth D., Carlos Martinez Del Rio, Stuart Bearhop, and Donald L. Phillips. 2007. <span>“A Niche for Isotopic Ecology.”</span> <em>Frontiers in Ecology and the Environment</em> 5 (8): 429–36. <a href="https://doi.org/10.1890/060150.1">https://doi.org/10.1890/060150.1</a>.
</div>
<div id="ref-swanson2015" class="csl-entry" role="listitem">
Swanson, Heidi K., Martin Lysy, Michael Power, Ashley D. Stasko, Jim D. Johnson, and James D. Reist. 2015. <span>“A New Probabilistic Method for Quantifying <span><em>n</em></span> -Dimensional Ecological Niches and Niche Overlap.”</span> <em>Ecology</em> 96 (2): 318–24. <a href="https://doi.org/10.1890/14-0235.1">https://doi.org/10.1890/14-0235.1</a>.
</div>
<div id="ref-vandeschoot2021" class="csl-entry" role="listitem">
van de Schoot, Rens, Sarah Depaoli, Ruth King, Bianca Kramer, Kaspar Märtens, Mahlet G. Tadesse, Marina Vannucci, et al. 2021. <span>“Bayesian Statistics and Modelling.”</span> <em>Nature Reviews Methods Primers</em> 1 (1): 1–26. <a href="https://doi.org/10.1038/s43586-020-00001-2">https://doi.org/10.1038/s43586-020-00001-2</a>.
</div>
</div></section></div></main> <!-- /main -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
    body {
        align-items: center;
    }

    .footer-container {
        text-align: center;
        line-height: 1.6; /* Adjust this value to change line spacing */
    }

    .contact-links {
        display: flex;
        justify-content: center;
        width: 100%;
        margin: 10px 0; /* Add space above and below contact links */
    }

    .contact-links a {
        margin: 0 10px; /* Add space between links */
        color: #888;
        text-decoration: none;
        display: flex;
        align-items: center;
    }

    .contact-links a:hover {
        color: #f2a94f;
    }

    .contact-links a i {
        margin-right: 5px;
        font-size: 0.8rem;
    }

    .contact-links a span {
        font-size: 0.8rem;
    }

    .footer-text {
        font-size: 0.8rem;
        text-align: center;
        margin: 5px 0; /* Add space above and below text */
    }

    @media (max-width: 720px) {
        .contact-links a span {
            display: none;
        }

        .contact-links a i {
            margin-right: 0;
        }
    }
</style>

<div class="footer-container">
    <hr>
    <p class="footer-text">Copyright © 2024 Zhehao Hu | <a href="https://github.com/zzzhehao/zzzhehao.github.io/blob/main/LICENSE">MIT license</a></p>
    <div class="contact-links">
        <a href="mailto:hu_zhehao@hotmail.com" title="E-Mail"><i class="fas fa-envelope"></i><span> E-Mail</span></a>
        <a href="https://www.linkedin.com/in/zhehaohu/" title="LinkedIn"><i class="fab fa-linkedin"></i><span> LinkedIn</span></a>
        <a href="https://github.com/zzzhehao/" title="GitHub"><i class="fab fa-github"></i><span> GitHub</span></a>
        <a href="https://instagram.com/zhehao.hu_" title="Instagram"><i class="fab fa-instagram"></i><span> Instagram</span></a>
    </div>
    <p class="footer-text">Issues on the website? <a href="https://github.com/zzzhehao/zzzhehao.github.io/issues">Report issues</a>. Source code available at <a href="https://github.com/zzzhehao/zzzhehao.github.io/">github.com</a>.</p>
    <hr>
</div>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/zzzhehao\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb12" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Niche Overlap Analysis using stable isotope data and nicheROVER</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> https://images.unsplash.com/photo-1588260693028-1308137adf56?q=80&amp;w=2500&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="an">abstract:</span><span class="co"> Stable isotope analysis (SIA) provides numerous information while assessing species' ecological niche, the R package *nicheROVER* offers an insightful analysis using stable isotope data.</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "  "</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">  - Ecology</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">  - Community Ecology</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">  - Data Analysis</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - Multivariate Analysis</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">  - openlinksinnewpage</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - nutshell</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="an">number headings:</span><span class="co"> auto, first-level 3, max 4, 2</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>::: {.disclaimer}</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>Part of this note is taken from the course *Community Ecology* offered by <span class="co">[</span><span class="ot">University of Hamburg</span><span class="co">](https://www.biologie.uni-hamburg.de/en.html)</span> for M.Sc. Biology program and led by <span class="co">[</span><span class="ot">Dr. Paula Cabral Eterovick</span><span class="co">](https://www.researchgate.net/profile/Paula-Eterovick-2)</span>. </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>The cover image is credited to <span class="co">[</span><span class="ot">Europeana on Unsplash</span><span class="co">](https://unsplash.com/photos/silver-and-yellow-fish-on-brown-wooden-table-vlmb9C2Ah_s)</span>.</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Niche Overlap</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>In my previous note, <span class="co">[</span><span class="ot">Ecological Niche</span><span class="co">](/biology-research/community-ecology/Ecological-Niche.qmd)</span>, we talked about the basic ideas about the ecological niche and niche overlap. Understanding the niche overlap pattern, both intraspecific and interspecific, can help us obtain more insight into many topics, such as:</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>Evolutionary:</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Sexual Dimorphism** by study difference in resource utilizing between males and females of the same species.</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Speciation Process** by study niche partitioning between sister taxa or subspecies.</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>Conservation:</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Impact of the Invasive Species** by looking at the niche overlap between native and invasive species.</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Ecological Guild** by understanding niche overlap within a group sharing same or similar functional trait (e.g. pollinator communities).</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>However, comparing niches among multiple species is challenging, as I mentioned already, since the ecological data are almost always multidimensional.</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## `nicheROVER`</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>The package <span class="in">`nicheROVER`</span> provides a new probabilistic method for quantifying n-dimensional ecological niche and niche overlap <span class="co">[</span><span class="ot">@swanson2015</span><span class="co">]</span>. The script demonstrated here is written by Martin Lysy, Heidi Swanson (see <span class="co">[</span><span class="ot">here</span><span class="co">](https://cran.r-project.org/web/packages/nicheROVER/vignettes/ecol-vignette.html)</span>), also used in the publication for the method demonstration.  </span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="in">`fish`</span> is a **fish stable isotope dataset** coming along in the package, containing values for three stable isotopes (N-15, C-13, S-34) measured in the muscle tissue of four arctic fish species (ARCS, BDWF, LKWF, LSCS), more details can be found from the documentation (<span class="in">`?fish`</span>) or in the publication.</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="fu">c</span>(<span class="st">"rmarkdown"</span>, <span class="st">"knitr"</span>, <span class="st">"tidyverse"</span>, <span class="st">"nicheROVER"</span>, <span class="st">"gtsummary"</span>), <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nicheROVER)</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(fish)</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-fish</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: \`fish\` dataset</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a><span class="fu">paged_table</span>(fish)</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a><span class="fu">## What is SIA?</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>**Stable isotope analysis (SIA)** is a powerful tool in ecological niche analysis. Many physicochemical and biochemical processes are sensitive to differences in the dissociation energies of molecules, which often depend on the mass of the elements from which these molecules are made. Thus, the isotopic composition of many materials (expressed as $\delta$-values), including the tissues of organisms, often contains a label of the process that created it <span class="co">[</span><span class="ot">@newsome2007a</span><span class="co">]</span>. These "signatures" provides detailed insights into their ecological roles and interactions.</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>| Gradient                               | Isotope system                                     | High $\delta$-values | Low $\delta$-values  |</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>| -------------------------------------- | -------------------------------------------------- | -------------------- | -------------------- |</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>| Trophic level                          | $\delta ^{13} C$/$\delta ^{15} N$                  | High levels          | Low levels           |</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>| C&lt;sub&gt;3&lt;/sub&gt;-C&lt;sub&gt;4&lt;/sub&gt; Vegetation | $\delta ^{13} C$                                   | C&lt;sub&gt;4&lt;/sub&gt; plants | C&lt;sub&gt;3&lt;/sub&gt; plants |</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>| Marine-terrestrial                     | $\delta ^{15} N$/$\delta ^{13} C$/$\delta ^{34} S$ | High levels          | Low levels           |</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>: A few common isotope systems and expected patterns in $\delta$-values, subsetted from <span class="co">[</span><span class="ot">@newsome2007a</span><span class="co">]</span> {#tbl-SIAs}</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: asis</span></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"functions/custom-callout.R"</span>)</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>content <span class="ot">&lt;-</span> <span class="st">"- @newsome2007a</span></span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a><span class="st">- @michel2021</span></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a><span class="st">- @moyo2021</span></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a><span class="st">- @2024"</span></span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_callout</span>(<span class="st">"For more information about isotopic and atomic ecology"</span>, content, <span class="at">collapse =</span> <span class="cn">TRUE</span>, <span class="at">titleStyle =</span> <span class="st">"sub"</span>)</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian Workflow</span></span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bayesian theorem</span></span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>@vandeschoot2021 described the very foundation idea of the Bayesian statistics as following:</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>Bayesian statistics is an approach to data analysis based on Bayes' theorem, where available knowledge about parameters in a statistical model is updated with the information in observed data. The background knowledge is expressed as a **prior** distribution and combined with observational data in the form of a likelihood function to determine the **posterior distribution**.</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>That means, we make an initial estimation of our parameters (prior distribution), we observe data and update the model (posterior distribution). </span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>The Bayesian statistics is based on the **Bayes' theorem**, which is mathematically stated as following:</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>P(A|B)=\frac{P(B|A)P(A)}{P(B)}</span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>where,</span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$A$ and $B$ are events and $P(B)\neq 0$,</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$P(A|B)$: the probability of event $A$ occurring given that $B$ is true. It is also called the **posterior probability** (briefly *posterior*) of $A$ given $B$.</span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$P(B|A)$ is also a conditional probability: the probability of event&nbsp;$B$ occurring given that&nbsp;$A$ is true. It can also be interpreted as the likelihood of $A$ given a fixed $B$ because $P(B|A)=L(A|B)$. ($L$: likelihood function)</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$P(A)$ and $P(B)$ are the probabilities of observing $A$ and $B$ respectively without any given conditions; they are known as the **prior probability** and marginal probability.</span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a><span class="fu">### Why Bayesian Statistics?</span></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a>Bayesian statistics is a whole other framework and approach on statistical analysis by putting the Bayes' theorem at the center. Both classical and Bayesian inference, while trying to modelling data, have advantages and disadvantages of each. Bayesian inference is generally employed whenever uncertainty comes to play:</span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>::: {.mini}</span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a>There is also a practical advantage of the Bayesian approach, which is that all its inferences are probabilistic and thus can be represented by random simulations. For this reason, whenever we want to summarize uncertainty in estimation beyond simple confidence intervals, and whenever we want to use regression models for predictions, we go Bayesian.</span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a>― @gelman2024, P. 16</span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>@swanson2015 pointed out a viewpoint from the traditional niche overlap analysis that might introduce problems: geometric approach doesn't account for uncertainty, and also lacks of direction. It is very well illustrated by Fig. 1 in the publication:</span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">Comparison between geometric and probabilistic isotope overlap metrics. Isotope x is distributed in species A and B (x-axis); dashed lines show means. The 95% niche region (solid lines) of B is completely contained within that of A, such that the geometric overlap of B onto A is 100%. However, the probability that a randomly chosen member from A falls into the isotopic niche of B is only 35%. [@swanson2015]</span><span class="co">](https://esajournals.onlinelibrary.wiley.com/cms/asset/d9181a57-fa40-4f4a-9197-460929dad9f8/ecy2015962318-fig-0001-m.jpg)</span></span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a>By inviting the variance of the niche probability distribution, not only the mean, it now also differentiates the overlap in directions, which means the probability of a species A falling into species B is not equal to one of that species B falling into species A. And since this perspective starts to consider the probability in the models, a Bayesian workflow will provide more reliable and robust analysis. </span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Vector and Multivariate Normal Distribution</span></span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>Given an individual statistical unit, in our case, the niche described by three isotope ratios, a random vector is a group of variables that describes this mathematical system. Which is again, in our case, those three values of the isotope ratio. The distribution of each component of the random vector together forms a **multivariate distribution**. </span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a>When dealing with univariate (one-dimensional) analysis, we often assume that the variable is normally distributed. We do things likewise even with multivariate analysis. The **multivariate normal distribution** is a generalization of the univariate  normal distribution into higher dimensions, but it's not as simple as all components of the random vector being normal. It also requires every linear combination of arbitrary two components in the system being normally distributed (bivariate normal distribution), which is not always true even every single variable is normal on their own. And here comes the covariance matrix into play. Normal distribution is described by two variables, mean and standard deviation (sd), in which the latter being simply the square root of the variance. </span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a><span class="fu">### Covariance and covariance matrix</span></span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>**Covariance** is a measure of the joint variability of two variables, the sign of the covariance shows the tendency, i.e. one of the three possible linear relationships between two variables, which are:</span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>negative linear relationship, covariance is <span class="sc">\&lt;</span> 0</span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>no linear relationship, covariance is around 0</span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>positive linear relationship, covariance is <span class="sc">\&gt;</span> 0</span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a>The variance is a special case of the covariance in which the two variables are identical. The covariance itself is sensitive to the scale of the data, and it does not provide information of in what extent the two variables correlate with each other and how well the linear correlation fits the data. All these characteristics make covariance difficult to interpret, but it has become an important step stone for many interesting subsequent analysis, such as PCA, correlation analysis, etc.</span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a>A **covariance matrix** is a square matrix giving the covariance between each pair of elements, which is always symmetric, and the diagonal elements present the variance of each variable. The covariance matrix describe the joint behavior of every linear combination of two variables, analogue to univariate normal distribution, the covariance and the mean are used to described a multivariate normal distribution.</span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: asis</span></span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a>content <span class="ot">&lt;-</span> <span class="st">"- [StatQuest](https://www.youtube.com/watch?v=qtaqvPAeEJY) on YouTube (simply and clearly explained)"</span></span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_callout</span>(<span class="st">"For more information about covariance"</span>, content, <span class="at">collapse =</span> T, <span class="at">titleStyle =</span> <span class="st">"sub"</span>)</span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conjugate Prior</span></span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a>@jackson2011 suggested that the normal distribution is generally appropriate when dealing with stable isotope ratio, and this gives us a way to simplify the analysis by taking advantage of the **conjugate prior**. </span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a>A conjungate prior is a certain prior distribution, that when applied on certain likelihood function, the posterior distribution will also be in the same distribution family. Such as in univaraite analysis, a normal prior and a normal likelihood function results a normal posterior. In our case, the conjugate prior for the multivariate normal is the normal-inverse-wishart (NIW) distribution. It can be considered in two parts: the mean is following a normal distribution and the covariance is following an inverse-Wishart distribution. NIW is commonly used as the prior distribution when modeling a multivariate normal, but the mean and the covariances are unknown.</span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a>The probability of a random observation of a isotope ratio ($x$) belongs to species $s$ is following a normal distribution.</span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a>P(x |\text{species}=s) \backsim N(\mu_s \, , \Sigma_s)</span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a><span class="fu">## Monte Carlo with `niw.post()`</span></span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a>All prior knowledge we just went through, from basic Bayesian inference to the NIW distribution, is to understand the very two lines of code that implemented the Bayesian workflow into the analysis.</span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-187"><a href="#cb12-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-188"><a href="#cb12-188" aria-hidden="true" tabindex="-1"></a>nsamples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb12-189"><a href="#cb12-189" aria-hidden="true" tabindex="-1"></a>fish.par <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fish), fish<span class="sc">$</span>species,</span>
<span id="cb12-190"><a href="#cb12-190" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(ii) <span class="fu">niw.post</span>(<span class="at">nsamples =</span> nsamples, <span class="at">X =</span> fish[ii,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]))</span>
<span id="cb12-191"><a href="#cb12-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-193"><a href="#cb12-193" aria-hidden="true" tabindex="-1"></a><span class="in">`niw.post()`</span> uses a data matrix (<span class="in">`X`</span>) as observation data, calculate the posterior distribution and then draws a set of means and covariance matrix of a possible multivariate distribution, which includes the prior and our observation data. The main idea is that because analytically working with posterior multivariate distribution is too impractical, so we employ the <span class="co">[</span><span class="ot">:Monte Carlo approach</span><span class="co">](https://www.youtube.com/watch?v=7ESK5SaP-bc)</span> to have a view of the posterior. We use <span class="in">`tapply()`</span> to separately apply <span class="in">`r nsamples`</span> times of <span class="in">`niw.post()`</span> on each fish species.</span>
<span id="cb12-194"><a href="#cb12-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-195"><a href="#cb12-195" aria-hidden="true" tabindex="-1"></a>This results a list of 4 lists (species) of 2 matrix (mu and Sigma), where the mu matrix has a dimension of <span class="in">`r nsamples`</span> (sampling times) x 3 (number of variables), and the Sigma matrix has a dimension of <span class="in">`r nsamples`</span> (sampling times) x 3 x 3 (one slice = one covariance matrix).</span>
<span id="cb12-196"><a href="#cb12-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-197"><a href="#cb12-197" aria-hidden="true" tabindex="-1"></a>This particular data structure is critical for later application of <span class="in">`niche.par.plot()`</span>, see <span class="in">`?nichr.par.plot`</span> for more.</span>
<span id="cb12-198"><a href="#cb12-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-199"><a href="#cb12-199" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution appearance="minimal" style="font-sze:0.9rem; border-left: none; border: 1px solid var(--clcolor);" collapse="true"}</span>
<span id="cb12-200"><a href="#cb12-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-201"><a href="#cb12-201" aria-hidden="true" tabindex="-1"></a><span class="fu">## [See the result]{.cl-sub}</span></span>
<span id="cb12-202"><a href="#cb12-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-205"><a href="#cb12-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-206"><a href="#cb12-206" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fish.par)</span>
<span id="cb12-207"><a href="#cb12-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-208"><a href="#cb12-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-209"><a href="#cb12-209" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-210"><a href="#cb12-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-211"><a href="#cb12-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## Niche Parameters</span></span>
<span id="cb12-212"><a href="#cb12-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-213"><a href="#cb12-213" aria-hidden="true" tabindex="-1"></a><span class="in">`niche.par.plot()`</span> allows us to have a overview on Monte Carlo simulation of the posterior multivariate distribution of our $\mu$ and $\Sigma$. It shows the probability density curve of each variable. Use <span class="in">`plot.index`</span>, <span class="in">`plot.mu`</span> or <span class="in">`plot.Sigma`</span> to select which $\mu$ or $\Sigma$ to plot, or simply use <span class="in">`plot.mu = TRUE, plot.Sigma = TRUE`</span> to display all. See details in the document.</span>
<span id="cb12-214"><a href="#cb12-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-215"><a href="#cb12-215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.height=2, fig.align="center"}</span></span>
<span id="cb12-216"><a href="#cb12-216" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: The distribution of $\mu_1$ ($\delta^{15}N)$ and $\mu_2$ ($\delta^{13}C)$, as well as the $\Sigma_{12}$ is displayed here. </span></span>
<span id="cb12-217"><a href="#cb12-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-218"><a href="#cb12-218" aria-hidden="true" tabindex="-1"></a><span class="in">clrs &lt;- c('#348E8C', '#732C02', '#BF0404', '#F29F05') # colors for each species</span></span>
<span id="cb12-219"><a href="#cb12-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-220"><a href="#cb12-220" aria-hidden="true" tabindex="-1"></a><span class="in"># mu1 (del15N), mu2 (del13C), and Sigma12 </span></span>
<span id="cb12-221"><a href="#cb12-221" aria-hidden="true" tabindex="-1"></a><span class="in">par(mar = c(4, 5, .5, .1)+.1, oma = c(0,0,0,0), pty="s", mfrow = c(1,3))</span></span>
<span id="cb12-222"><a href="#cb12-222" aria-hidden="true" tabindex="-1"></a><span class="in">niche.par.plot(fish.par, col = clrs, plot.index = 1)</span></span>
<span id="cb12-223"><a href="#cb12-223" aria-hidden="true" tabindex="-1"></a><span class="in">niche.par.plot(fish.par, col = clrs, plot.index = 2)</span></span>
<span id="cb12-224"><a href="#cb12-224" aria-hidden="true" tabindex="-1"></a><span class="in">niche.par.plot(fish.par, col = clrs, plot.index = 1:2)</span></span>
<span id="cb12-225"><a href="#cb12-225" aria-hidden="true" tabindex="-1"></a><span class="in">legend("topleft", legend = names(fish.par), fill = clrs)</span></span>
<span id="cb12-226"><a href="#cb12-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-227"><a href="#cb12-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-228"><a href="#cb12-228" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2-D Ellipse Projection</span></span>
<span id="cb12-229"><a href="#cb12-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-230"><a href="#cb12-230" aria-hidden="true" tabindex="-1"></a>To dealing with n-dimensional niche region (N&lt;sub&gt;R&lt;/sub&gt;), @swanson2015 reduced them into 2-dimensional space using probabilistic projection, which is to differentiate from geometric projection. A 2-dimensional probabilistic projection of an n-dimensional N&lt;sub&gt;R&lt;/sub&gt; is simply the N&lt;sub&gt;R&lt;/sub&gt; calculated by the projected 2 axes <span class="co">[</span><span class="ot">@jackson2011; @swanson2015</span><span class="co">]</span>. Fig. 2 from @swanson2015 clearly demonstrate and explained the different outcome.</span>
<span id="cb12-231"><a href="#cb12-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-232"><a href="#cb12-232" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">A three-dimensional 95% niche region for normally distributed isotopes. The two ellipses are projections of the niche region (NR) onto isotope axes U and V. The black, hatched ellipse is the geometric projection of NR onto this plane, which is the shadow obtained by shining a light onto the three-dimensional ellipsoid along the W-axis (in blue). This is the largest of the two-dimensional ellipse “slices” taken parallel to the UV-plane. The red ellipse is the 95% niche region constructed directly from isotopes U and V. Thus, the geometric projection of the ellipsoid covers less than 95% of randomly selected individuals in two-dimensional isotope space. [@swanson2015]</span><span class="co">](https://esajournals.onlinelibrary.wiley.com/cms/asset/91c8eaef-f65e-4f7c-9eb7-b491b568943e/ecy2015962318-fig-0002-m.gif)</span></span>
<span id="cb12-233"><a href="#cb12-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-234"><a href="#cb12-234" aria-hidden="true" tabindex="-1"></a>For the sake of clearness, we only use 10 simulations here. <span class="in">`niche.plot()`</span> generates three types of plot:</span>
<span id="cb12-235"><a href="#cb12-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-236"><a href="#cb12-236" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Univariate distribution density curves, i.e. smoothed histogram.</span>
<span id="cb12-237"><a href="#cb12-237" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Bivariate scatter plots.</span>
<span id="cb12-238"><a href="#cb12-238" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>2-D projection of N&lt;sub&gt;R&lt;/sub&gt; by using simulation data, displayed in ellipse plots.</span>
<span id="cb12-239"><a href="#cb12-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-240"><a href="#cb12-240" aria-hidden="true" tabindex="-1"></a>From the first two plot types, we could confirmed the assumption that the isotope ratios are generally normal. While the ellipse plots give us a better view of each species' N&lt;sub&gt;R&lt;/sub&gt; and the overlap situation.</span>
<span id="cb12-241"><a href="#cb12-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-242"><a href="#cb12-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.height=9, fig.width=9, fig.align="center"}</span></span>
<span id="cb12-243"><a href="#cb12-243" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: niche.plot</span></span>
<span id="cb12-244"><a href="#cb12-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-245"><a href="#cb12-245" aria-hidden="true" tabindex="-1"></a><span class="in">nsamples &lt;- 10</span></span>
<span id="cb12-246"><a href="#cb12-246" aria-hidden="true" tabindex="-1"></a><span class="in">fish.par &lt;- tapply(1:nrow(fish), fish$species,</span></span>
<span id="cb12-247"><a href="#cb12-247" aria-hidden="true" tabindex="-1"></a><span class="in">            function(ii) niw.post(nsamples = nsamples, X = fish[ii,2:4]))</span></span>
<span id="cb12-248"><a href="#cb12-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-249"><a href="#cb12-249" aria-hidden="true" tabindex="-1"></a><span class="in"># format data for plotting function</span></span>
<span id="cb12-250"><a href="#cb12-250" aria-hidden="true" tabindex="-1"></a><span class="in">fish.data &lt;- tapply(1:nrow(fish), fish$species, function(ii) X = fish[ii,2:4])</span></span>
<span id="cb12-251"><a href="#cb12-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-252"><a href="#cb12-252" aria-hidden="true" tabindex="-1"></a><span class="in">niche.plot(niche.par = fish.par, niche.data = fish.data, pfrac = .05,</span></span>
<span id="cb12-253"><a href="#cb12-253" aria-hidden="true" tabindex="-1"></a><span class="in">           iso.names = expression(delta^{15}*N, delta^{13}*C, delta^{34}*S),</span></span>
<span id="cb12-254"><a href="#cb12-254" aria-hidden="true" tabindex="-1"></a><span class="in">           col = clrs, xlab = expression("Isotope Ratio (per mil)"))</span></span>
<span id="cb12-255"><a href="#cb12-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-256"><a href="#cb12-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-257"><a href="#cb12-257" aria-hidden="true" tabindex="-1"></a>It's a bit overwhelming plot. Take time to understand it.</span>
<span id="cb12-258"><a href="#cb12-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-259"><a href="#cb12-259" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimate Niche Overlap</span></span>
<span id="cb12-260"><a href="#cb12-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-261"><a href="#cb12-261" aria-hidden="true" tabindex="-1"></a>With <span class="in">`overlap()`</span> we can have a more accurate and robust inference of overlapping among the species, the accuracy of the estimation can be improved by increasing <span class="in">`nprob`</span>. Generated plot shows pairwise niche overlaps (now we have directions!), which displays the probability distribution of species A (along rows) fallen inside the niche of species B (along columns), with indication of the mean and confidence interval (95% in the show case). </span>
<span id="cb12-262"><a href="#cb12-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-263"><a href="#cb12-263" aria-hidden="true" tabindex="-1"></a>Be careful not to confuse two 95% here - one means that we use 95% of the niche region to calculate overlap, which is specified in <span class="in">`overlap()`</span> with <span class="in">`alpha = 0.95`</span>; the other is the 95% credible interval of the probability distribution displayed in each plot. There is difference to spot between plots using 95% or 99% of the niche region.</span>
<span id="cb12-264"><a href="#cb12-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-265"><a href="#cb12-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.align="center"}</span></span>
<span id="cb12-266"><a href="#cb12-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-267"><a href="#cb12-267" aria-hidden="true" tabindex="-1"></a><span class="in">nsamples &lt;- 1000</span></span>
<span id="cb12-268"><a href="#cb12-268" aria-hidden="true" tabindex="-1"></a><span class="in">fish.par &lt;- tapply(1:nrow(fish), fish$species,</span></span>
<span id="cb12-269"><a href="#cb12-269" aria-hidden="true" tabindex="-1"></a><span class="in">            function(ii) niw.post(nsamples = nsamples, X = fish[ii,2:4]))</span></span>
<span id="cb12-270"><a href="#cb12-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-271"><a href="#cb12-271" aria-hidden="true" tabindex="-1"></a><span class="in"># 95% niche region</span></span>
<span id="cb12-272"><a href="#cb12-272" aria-hidden="true" tabindex="-1"></a><span class="in">over.stat95 &lt;- overlap(fish.par, nreps = nsamples, nprob = 1000, alpha = 0.95)</span></span>
<span id="cb12-273"><a href="#cb12-273" aria-hidden="true" tabindex="-1"></a><span class="in">overlap.plot(over.stat95, col = clrs, mean.cred.col = "#024873", equal.axis = TRUE, xlab = "Overlap Probability (%) -- Niche Region Size: 95%")</span></span>
<span id="cb12-274"><a href="#cb12-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-275"><a href="#cb12-275" aria-hidden="true" tabindex="-1"></a><span class="in"># 99% niche region</span></span>
<span id="cb12-276"><a href="#cb12-276" aria-hidden="true" tabindex="-1"></a><span class="in">over.stat99 &lt;- overlap(fish.par, nreps = nsamples, nprob = 1000, alpha = 0.99)</span></span>
<span id="cb12-277"><a href="#cb12-277" aria-hidden="true" tabindex="-1"></a><span class="in">overlap.plot(over.stat99, col = clrs, mean.cred.col = "#024873", equal.axis = TRUE, xlab = "Overlap Probability (%) -- Niche Region Size: 99%")</span></span>
<span id="cb12-278"><a href="#cb12-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-279"><a href="#cb12-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-280"><a href="#cb12-280" aria-hidden="true" tabindex="-1"></a>By printing out the returned value from <span class="in">`overlap()`</span>, numeric result can also be showed. </span>
<span id="cb12-281"><a href="#cb12-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-282"><a href="#cb12-282" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution appearance="minimal" style="font-sze:0.9rem; border-left: none; border: 1px solid var(--clcolor);" collapse="true"}</span>
<span id="cb12-283"><a href="#cb12-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-284"><a href="#cb12-284" aria-hidden="true" tabindex="-1"></a><span class="fu">## [See detailed results]{.cl-sub}</span></span>
<span id="cb12-285"><a href="#cb12-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-286"><a href="#cb12-286" aria-hidden="true" tabindex="-1"></a>We could calculate the estimation for both alpha = 0.99 and 0.95 at the same time.</span>
<span id="cb12-287"><a href="#cb12-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-290"><a href="#cb12-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-291"><a href="#cb12-291" aria-hidden="true" tabindex="-1"></a>over.stat<span class="fl">.2</span>lvl <span class="ot">&lt;-</span> <span class="fu">overlap</span>(fish.par, <span class="at">nreps =</span> nsamples, <span class="at">nprob =</span> <span class="dv">1000</span>, <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.99</span>))</span>
<span id="cb12-292"><a href="#cb12-292" aria-hidden="true" tabindex="-1"></a>over.mean<span class="fl">.2</span>lvl <span class="ot">&lt;-</span> <span class="fu">apply</span>(over.stat<span class="fl">.2</span>lvl, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span>), mean)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb12-293"><a href="#cb12-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-294"><a href="#cb12-294" aria-hidden="true" tabindex="-1"></a><span class="co"># Here are the mean of each overlap probability distribution</span></span>
<span id="cb12-295"><a href="#cb12-295" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(over.mean<span class="fl">.2</span>lvl, <span class="dv">2</span>)</span>
<span id="cb12-296"><a href="#cb12-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-297"><a href="#cb12-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-300"><a href="#cb12-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-301"><a href="#cb12-301" aria-hidden="true" tabindex="-1"></a><span class="co"># Here are the upper and lower bounds of the 95% credible interval</span></span>
<span id="cb12-302"><a href="#cb12-302" aria-hidden="true" tabindex="-1"></a>over.cred <span class="ot">&lt;-</span> <span class="fu">apply</span>(over.stat<span class="fl">.2</span>lvl<span class="sc">*</span><span class="dv">100</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span>), quantile, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-303"><a href="#cb12-303" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(over.cred)</span>
<span id="cb12-304"><a href="#cb12-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-305"><a href="#cb12-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-306"><a href="#cb12-306" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","selector":".lightbox","loop":false,"closeEffect":"zoom","descPosition":"bottom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>