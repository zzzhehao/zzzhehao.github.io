{
  "hash": "50e25a0a0e645a2e41acf49cefc8c4ae",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"1 Discriminant analysis\"\ndate: \"September 22, 2024\"\ndraft: true\n---\n\n\n\n# What is Linear Discriminant Analysis (LDA)?\n\nA definition from [IBM](https://www.ibm.com/docs/en/spss-statistics/beta?topic=features-discriminant-analysis):\n\nDiscriminant analysis builds a predictive model for group membership. The model is composed of a discriminant function (or, for more than two groups, a set of discriminant functions) based on linear combinations of the predictor variables that provide the best discrimination between the groups. The functions are generated from a sample of cases for which group membership is known; the functions can then be applied to new cases that have measurements for the predictor variables but have unknown group membership.\n\n# Script `Script_niche1.R`\n\n\n\n\n\n\n\nImport Data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#this is a way to open a datasheet using a txt file (which can be saved from excel)\nlizards<-(read.table(\"/Users/hu_zhehao/Library/Mobile Documents/com~apple~CloudDocs/Files/Obsidian/Cafe AgX HQ 2.0/004 Notes/M.Sc. Biology/Community Ecology/Practice/transect11_day.txt\",header=TRUE))\n#to see the data, click on it at the upper pannel on the right or use the command: \n# list(lizards) #all the data\nhead(lizards) #just the first lines\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Species Sex distance height     time\n1   Geckolepis  ni      0.5    1.2 11.50000\n2   Geckolepis  ni      0.2    0.0 12.10000\n3   Geckolepis  ni      0.4    1.7 13.33333\n4   Geckolepis  ni      1.9    1.2 14.41667\n5   Geckolepis  ni      1.9    1.4 14.41667\n6 Hemidactylus  ni      0.4    0.3 10.68333\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lizards)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Species              Sex               distance         height      \n Length:37          Length:37          Min.   :0.200   Min.   :0.0000  \n Class :character   Class :character   1st Qu.:1.000   1st Qu.:0.0000  \n Mode  :character   Mode  :character   Median :2.000   Median :0.7000  \n                                       Mean   :2.349   Mean   :0.8892  \n                                       3rd Qu.:3.000   3rd Qu.:1.2000  \n                                       Max.   :6.000   Max.   :5.0000  \n      time      \n Min.   :10.00  \n 1st Qu.:11.67  \n Median :12.78  \n Mean   :12.73  \n 3rd Qu.:14.03  \n Max.   :15.10  \n```\n\n\n:::\n:::\n\n\n\nTo test if the datas are with equal variances, the test tests of the null that the variances in each of the groups are the same.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbartlett.test(lizards$distance + lizards$height + lizards$time ~ lizards$Species, data=lizards)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  lizards$distance + lizards$height + lizards$time by lizards$Species\nBartlett's K-squared = 2.5755, df = 5, p-value = 0.7651\n```\n\n\n:::\n:::\n\n\n\nP is way bigger than significance, not rejecting null, they have all equal variance.\n\nNow we do the LDA:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- lda(Species ~ distance + height + time, data=lizards, na.action=\"na.omit\", CV=TRUE)\n#na.action specifies what to do with variables with missing values. na.omit excludes samples with missing values and proceeds with the analyses.\n#if such samples exist but na.action is not specified, the analysis won't run (default option)\n# If CV = TRUE the return value is a list with components class, the MAP classification (a factor), and posterior, posterior probabilities for the classes.\nfit # show results \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$class\n [1] Hemidactylus            Hemidactylus            Geckolepis             \n [4] Hemidactylus            Hemidactylus            Mabuya_gravenhorsti    \n [7] Mabuya_gravenhorsti     Geckolepis              Geckolepis             \n[10] Mabuya_gravenhorsti     Mabuya_gravenhorsti     Mabuya_gravenhorsti    \n[13] Mabuya_gravenhorsti     Hemidactylus            Oplurus_cuvieri        \n[16] Hemidactylus            Mabuya_gravenhorsti     Mabuya_gravenhorsti    \n[19] Mabuya_gravenhorsti     Mabuya_gravenhorsti     Mabuya_gravenhorsti    \n[22] Hemidactylus            Mabuya_gravenhorsti     Geckolepis             \n[25] Hemidactylus            Zonosaurus_laticaudatus Oplurus_cuvieri        \n[28] Mabuya_gravenhorsti     Hemidactylus            Mabuya_gravenhorsti    \n[31] Mabuya_gravenhorsti     Mabuya_gravenhorsti     Mabuya_gravenhorsti    \n[34] Mabuya_gravenhorsti     Mabuya_gravenhorsti     Mabuya_gravenhorsti    \n[37] Mabuya_gravenhorsti    \n6 Levels: Geckolepis Hemidactylus Lygodactylus ... Zonosaurus_laticaudatus\n\n$posterior\n    Geckolepis Hemidactylus Lygodactylus Mabuya_gravenhorsti Oplurus_cuvieri\n1  0.197427920   0.28595953 0.2401963771        1.574824e-01     0.019035626\n2  0.165371039   0.26602775 0.1313010272        2.488356e-01     0.003878726\n3  0.315939031   0.28413202 0.2912637883        6.021569e-02     0.009461662\n4  0.167665723   0.34044317 0.1665582327        1.782019e-01     0.022438604\n5  0.176368033   0.34599794 0.1865952805        1.571891e-01     0.026130599\n6  0.211193278   0.12436771 0.1423392697        3.052013e-01     0.010075358\n7  0.050526439   0.12591867 0.0637728061        3.874833e-01     0.129885103\n8  0.336705252   0.23813197 0.2486307130        1.001474e-01     0.010194808\n9  0.409355297   0.16980496 0.3451198027        4.044615e-02     0.010100902\n10 0.095887288   0.22832852 0.0904071582        3.096588e-01     0.064190803\n11 0.070615511   0.15842272 0.0511456165        3.961184e-01     0.028722266\n12 0.129135507   0.22727588 0.1063394291        2.855959e-01     0.047507383\n13 0.054773089   0.12974384 0.0053204474        4.692118e-01     0.017651838\n14 0.244863865   0.26977409 0.0475058914        2.466184e-01     0.003355480\n15 0.021693698   0.01886678 0.0000119837        6.120502e-05     0.959348988\n16 0.310244155   0.34199048 0.0867511265        1.459670e-01     0.006096916\n17 0.043890150   0.12226026 0.0397672869        3.919667e-01     0.034720302\n18 0.005663782   0.04575166 0.0072788845        4.264473e-01     0.101913687\n19 0.014311172   0.08597442 0.0249833293        3.111772e-01     0.309892412\n20 0.048913747   0.16398204 0.0597483178        3.587094e-01     0.120301065\n21 0.032335187   0.12059842 0.0262458615        4.545498e-01     0.030063080\n22 0.193261346   0.26451009 0.1143896614        2.230476e-01     0.007522215\n23 0.109329651   0.22327718 0.0688705955        3.239674e-01     0.012394957\n24 0.363151212   0.31398080 0.2053561602        4.976253e-02     0.003804827\n25 0.204202731   0.33660902 0.1347878277        1.532107e-01     0.015106689\n26 0.002222427   0.05060585 0.0024357578        2.120196e-01     0.156443033\n27 0.001804876   0.02337733 0.0195511277        4.248492e-02     0.897374134\n28 0.029873632   0.13924906 0.0441185133        3.509767e-01     0.220343910\n29 0.123587584   0.28393894 0.1964960849        1.545194e-01     0.153105265\n30 0.026315367   0.11410791 0.0189618565        4.789932e-01     0.002596692\n31 0.021334790   0.09081831 0.0206333531        5.324707e-01     0.046088680\n32 0.145030907   0.24792415 0.1203595185        2.994683e-01     0.027830797\n33 0.190582528   0.26266016 0.1350213713        2.651431e-01     0.013942290\n34 0.166647515   0.24160679 0.0964048233        3.114087e-01     0.007101625\n35 0.001257848   0.02794407 0.0023229485        5.119721e-01     0.349224803\n36 0.022152903   0.11773329 0.0234136633        4.704317e-01     0.085831503\n37 0.125143430   0.28469677 0.0639263582        3.604825e-01     0.008502016\n   Zonosaurus_laticaudatus\n1             0.0998981808\n2             0.1845858409\n3             0.0389878102\n4             0.1246924133\n5             0.1077190732\n6             0.2068231004\n7             0.2424137142\n8             0.0661898336\n9             0.0251728884\n10            0.2115274180\n11            0.2949755192\n12            0.2041458929\n13            0.3232990341\n14            0.1878822338\n15            0.0000173427\n16            0.1089503598\n17            0.3673953369\n18            0.4129446585\n19            0.2536614370\n20            0.2483454352\n21            0.3362076547\n22            0.1972691296\n23            0.2621602161\n24            0.0639444755\n25            0.1560830359\n26            0.5762733047\n27            0.0154076039\n28            0.2154382171\n29            0.0883527446\n30            0.3590249672\n31            0.2886541861\n32            0.1593863656\n33            0.1326505929\n34            0.1768305935\n35            0.1072782097\n36            0.2804369321\n37            0.1572488763\n\n$terms\nSpecies ~ distance + height + time\nattr(,\"variables\")\nlist(Species, distance, height, time)\nattr(,\"factors\")\n         distance height time\nSpecies         0      0    0\ndistance        1      0    0\nheight          0      1    0\ntime            0      0    1\nattr(,\"term.labels\")\n[1] \"distance\" \"height\"   \"time\"    \nattr(,\"order\")\n[1] 1 1 1\nattr(,\"intercept\")\n[1] 1\nattr(,\"response\")\n[1] 1\nattr(,\".Environment\")\n<environment: R_GlobalEnv>\nattr(,\"predvars\")\nlist(Species, distance, height, time)\nattr(,\"dataClasses\")\n    Species    distance      height        time \n\"character\"   \"numeric\"   \"numeric\"   \"numeric\" \n\n$call\nlda(formula = Species ~ distance + height + time, data = lizards, \n    CV = TRUE, na.action = \"na.omit\")\n\n$xlevels\nnamed list()\n```\n\n\n:::\n:::\n\n\n\n- Posterior distribution is the mean value of the simulation.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nct <- table(lizards$Species, fit$class)\ndiag(prop.table(ct, 1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Geckolepis            Hemidactylus            Lygodactylus \n                   0.20                    0.00                    0.00 \n    Mabuya_gravenhorsti         Oplurus_cuvieri Zonosaurus_laticaudatus \n                   0.60                    0.25                    0.00 \n```\n\n\n:::\n\n```{.r .cell-code}\nsum(diag(prop.table(ct)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2162162\n```\n\n\n:::\n:::\n\n\n\n`sum` will give us the probability of getting a random lizard and assigning it to the correct species only based on its habitat use data #markTodo How?\nIn another woord, this shows if the species have difference in using habitat, in our case, not. #markTodo but how is this value calculated\n\nNow we do the LDA again, but with `CV=FALSE`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lda(Species ~ distance + height + time, data=lizards)\nmodel\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\nlda(Species ~ distance + height + time, data = lizards)\n\nPrior probabilities of groups:\n             Geckolepis            Hemidactylus            Lygodactylus \n              0.1351351               0.1891892               0.1081081 \n    Mabuya_gravenhorsti         Oplurus_cuvieri Zonosaurus_laticaudatus \n              0.2702703               0.1081081               0.1891892 \n\nGroup means:\n                        distance    height     time\nGeckolepis              0.980000 1.1000000 13.15333\nHemidactylus            1.900000 1.0428571 13.07619\nLygodactylus            1.400000 1.4500000 12.97917\nMabuya_gravenhorsti     2.760000 0.4200000 12.46667\nOplurus_cuvieri         4.125000 1.9750000 12.35833\nZonosaurus_laticaudatus 2.714286 0.3142857 12.53571\n\nCoefficients of linear discriminants:\n                LD1         LD2        LD3\ndistance  0.6699366  0.15307633  0.1927697\nheight   -0.3812761  0.92784838 -0.1043009\ntime     -0.2420559 -0.09456431  0.6130432\n\nProportion of trace:\n   LD1    LD2    LD3 \n0.6404 0.3550 0.0046 \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(model, dimen = 2)\n```\n\n::: {.cell-output-display}\n![](draft1_Discriminant_analysis_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\nUse ggplot for visualization.\n",
    "supporting": [
      "draft1_Discriminant_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}