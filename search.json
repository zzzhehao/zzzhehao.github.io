[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  },
  {
    "objectID": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html",
    "href": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html",
    "title": "Community Ecology 1 - NMDS, PERMDISP and PERMANOVA",
    "section": "",
    "text": "We have multidimensional data in ecology, almost always, and they are huge. Since an n-dimensional data requires an n-dimensional space to be 1:1 displayed, if we want to have at least an overview, we need to reduce dimensions.\nFor example, we have a species abundance data that can be used for describing the difference between communities. What if we have additional habitat data from each community and we want to find out which environmental condition is effecting the community composition? There’s a few technics can help us answer these questions, which are called as MultiDimensional Scaling (MDS), the widely used metric MDS is PCoA and its special type PCA when calculating euclidean distance."
  },
  {
    "objectID": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html#the-problem",
    "href": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html#the-problem",
    "title": "Community Ecology 1 - NMDS, PERMDISP and PERMANOVA",
    "section": "",
    "text": "We have multidimensional data in ecology, almost always, and they are huge. Since an n-dimensional data requires an n-dimensional space to be 1:1 displayed, if we want to have at least an overview, we need to reduce dimensions.\nFor example, we have a species abundance data that can be used for describing the difference between communities. What if we have additional habitat data from each community and we want to find out which environmental condition is effecting the community composition? There’s a few technics can help us answer these questions, which are called as MultiDimensional Scaling (MDS), the widely used metric MDS is PCoA and its special type PCA when calculating euclidean distance."
  },
  {
    "objectID": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html#what-is-nmds",
    "href": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html#what-is-nmds",
    "title": "Community Ecology 1 - NMDS, PERMDISP and PERMANOVA",
    "section": "What is NMDS?",
    "text": "What is NMDS?\nThe Non-metric MultiDimensional Scaling (NMDS) is, as its name implicates, the MDS for non-metric data. Which can be more convenient in analyzing ecology data, since the ecological data often don’t follow the normal distribution.\nAs Wikipedia explains, the NMDS finds a non-parametric monotonic relationship between the dissimilarities in the item-item matrix and the Euclidean distance between items, and the location of each item in the low-dimensional space.\nTranslate this into simplified language, it says the NMDS …\n\nhighlights the similarities between samples of multidimensional measurements.\nreduces the dimensions of the multidimensional data, but the number of dimensions are predefined, in contrast to PCA and PCoA, which always show the most important two axes.\nanalyses distance matrix, which is commonly a dissimilarity distance matrix.\nis a visualization method, it has thus less precision and much less accountability for further usage of the analysis result in compare to the PCA. For a statistical assessment, additional tests regarding to particular hypothesis must be performed, and that’s why we are combining NMDS with PERMANOVA.\nuses a rank based approach (which makes NMDS a non-metric technic), this rank is maintained consistent while reducing dimensions (monotonic).\nis an iterative algorithm, which use stress values to guide the iteration (see ?metaMDS Details#4). NMDS tries to improve the iteration by randomly choosing starting point.\n\n\nStress\nThe inconsistency between the original high-dimensional data and the reduced low-dimensional data is measured by stress in each iteration. The value ranges from 0 to 1, where 0 means a perfecto fit and 1 means a big yikes.\nGenerally, stress values below 0.2 are considered acceptable, below 0.1 are good. The stress value should be reported with NMDS while publishing results.\nHigher number of samples often leads to higher stress value, also a very low stress value might indicate that the dataset is too small for the NMDS."
  },
  {
    "objectID": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html#getting-started",
    "href": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html#getting-started",
    "title": "Community Ecology 1 - NMDS, PERMDISP and PERMANOVA",
    "section": "Getting started",
    "text": "Getting started\nWe will use the metaNDS() from package vegan to calculate NMDS and visualize the result using ordiplot(). As demonstration, we use a tadpole abundance data collected in a Madagascan rain forest:\n\nsource(\"ProjectAnalysis/Data_Manipulation/tadpole_clean.R\")\ntadpoleSp &lt;- tadpoleSp[, -1] # drop first column (transects)\n\n\ndim(tadpoleSp)\n\n[1] 29 45\n\nstr(tadpoleSp[, c(1:6)]) # only showing the first 6 species\n\ntibble [29 × 6] (S3: tbl_df/tbl/data.frame)\n $ Boophis albilabris   : num [1:29] 0 0 0 0 0 0 0 0 0 0 ...\n $ Boophis albipunctatus: num [1:29] 0 0 0 0 0 0 0 0 0 0 ...\n $ Boophis andohahela   : num [1:29] 18 0 0 1 0 0 0 0 0 0 ...\n $ Boophis ankaratra    : num [1:29] 0 0 0 0 0 0 0 0 0 0 ...\n $ Boophis elenae       : num [1:29] 75 0 40 0 0 0 0 0 0 0 ...\n $ Boophis luteus       : num [1:29] 29 0 0 0 0 0 0 0 0 0 ..."
  },
  {
    "objectID": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html#running-nmds",
    "href": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html#running-nmds",
    "title": "Community Ecology 1 - NMDS, PERMDISP and PERMANOVA",
    "section": "Running NMDS",
    "text": "Running NMDS\nThe metaMDS has an argument autotransform defaults to TRUE, which arbitrarily transforms data if they exceeded certain sizes. However, the transformation should better be done independently.\n\ntadNMDS &lt;- metaMDS(tadpoleSp, k=2, autotransform = FALSE)\n\nThe code above will print out stress values from each iteration. The result with the least stress value can also be called out afterwards:\n\ntadNMDS\n\n\nCall:\nmetaMDS(comm = tadpoleSp, k = 2, autotransform = FALSE) \n\nglobal Multidimensional Scaling using monoMDS\n\nData:     tadpoleSp \nDistance: bray \n\nDimensions: 2 \nStress:     0.1713525 \nStress type 1, weak ties\nBest solution was not repeated after 20 tries\nThe best solution was from try 16 (random start)\nScaling: centring, PC rotation, halfchange scaling \nSpecies: expanded scores based on 'tadpoleSp'"
  },
  {
    "objectID": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html#visualizing-nmds",
    "href": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html#visualizing-nmds",
    "title": "Community Ecology 1 - NMDS, PERMDISP and PERMANOVA",
    "section": "Visualizing NMDS",
    "text": "Visualizing NMDS\nordiplot is a function specialized on visualizing ordination result from vegan. We can control the representation of sites or species easily using type and display argument. A simple plot with points will look like this:\n\nordiplot(tadNMDS, type = \"p\")\n\n\n\n\n\n\n\n\nor with the site displayed in their numbers:\n\nordiplot(tadNMDS, type = \"p\", display = \"species\")\norditorp(tadNMDS, display = \"site\") # orditorp plots text by default\n\n\n\n\n\n\n\n\n\nFitting environmental data using vegan\nAvailable environmental data could be combined with NMDS to identify potential driver in the community composition and help explain their clustering patterns.\n\nstr(env[, c(1:6)]) # only showing the first 6 variables\n\ntibble [29 × 6] (S3: tbl_df/tbl/data.frame)\n $ stream          : chr [1:29] \"Ambatolahy II\" \"Ambatolahy III\" \"Ambatovory Barrage\" \"Ambodiamontana\" ...\n $ date            : POSIXct[1:29], format: \"2007-03-08\" \"2007-03-10\" ...\n $ site            : chr [1:29] \"Ambatolahy II\" \"Ambatolahy III\" \"Ambatovory\" \"Ambodiamontana\" ...\n $ S (hddd°mm,mmm°): chr [1:29] \"21°14,468'\" \"21°14,464'\" \"21°13,862'\" \"21°15,249'\" ...\n $ E (hddd°mm,mmm°): chr [1:29] \"047°25,591'\" \"047°25,624'\" \"047°25,436'\" \"047°25,197'\" ...\n $ altitude [m asl]: num [1:29] 965 973 1028 935 982 ...\n\n\nThe two variable I’m showing here are both continuous, which will automatically result a 3d-representation, those are the two axes from NMDS and the third axis showing the environmental variable. Since we only have two dimensions, the third variable is represented as a projection of the 3d-surface. We use ordisurf here to fit a smooth surface to the environmental data, which calls gam() (generalized additive model) in the background (I might get back to this with more detailed explanation in the future).\n\ndepth &lt;- env.comp$`Depth (cm)`\n\npar(mfrow = c(1,2))\nordiplot(tadNMDS, type = \"p\", display = 'species', ylim = c(-1, 1), xlim = c(-0.5, 1))\norditorp(tadNMDS, display = \"site\", add = TRUE)\nordisurf(tadNMDS, depth, main = 'Depth', col = 'darkgreen', add = TRUE)\n\n\nFamily: gaussian \nLink function: identity \n\nFormula:\ny ~ s(x1, x2, k = 10, bs = \"tp\", fx = FALSE)\n\nEstimated degrees of freedom:\n6.64  total = 7.64 \n\nREML score: 109.5935     \n\naltitude &lt;- env.comp$`altitude [m asl]`\n\nordiplot(tadNMDS, type = \"p\", display = 'species', ylim = c(-1, 1), xlim = c(-0.5, 1))\norditorp(tadNMDS, display = \"site\", add = TRUE)\nordisurf(tadNMDS, altitude, main = 'Altitude', col = 'blue', add = TRUE)\n\n\n\n\n\n\n\n\n\nFamily: gaussian \nLink function: identity \n\nFormula:\ny ~ s(x1, x2, k = 10, bs = \"tp\", fx = FALSE)\n\nEstimated degrees of freedom:\n0.849  total = 1.85 \n\nREML score: 168.5419     \n\n\n\n\nPlotting NMDS using ggplot2\nIf you have ever worked with ggplot2 and its enormous family, you probably can’t go back to basic R plots. Fortunately, there’s a way to plot, not only the NMDS, also other ordination analyses from vegan using ggplot2. This can make our plot more precise and customizable.\n\nlibrary(ggplot2)\n\nWe continue with the already available NMDS result from earlier, which is stored inside tadNMDS. The only thing we need to do, is to extract the coordinates from the points we want to plot, and then apply them in a ggplot-way.\n\n# extract NMDS scores\nsiteCoord &lt;- as_tibble(scores(tadNMDS)$sites)\nspCoord &lt;- as_tibble(scores(tadNMDS)$species)\n\np.NMDS.sp &lt;- ggplot()+\n  coord_equal() +\n  theme_aes() + # set themes, available in source code Rmd\n  MoMAColor() + # use MoMA color palattes, available in source code Rmd\n  theme(aspect.ratio = 1) +\n  geom_point(data = spCoord, aes(x = NMDS1, y = NMDS2), size = 2, shape = 3, color = \"red\", alpha = 0.9) +\n  ylim(-1.6, 2)\n\np.NMDS.sp.st &lt;- p.NMDS.sp +\n  geom_point(data = siteCoord, aes(x = NMDS1, y = NMDS2), color = \"#222222\", size = 3.5, alpha = 0.5) +\n  geom_text(data = siteCoord, aes(x = NMDS1, y = NMDS2, label = c(1:nrow(siteCoord))), color = \"white\", size = 1.8, alpha = 1, check_overlap = T)\n\np.NMDS.sp.st\n\n\n\n\n\n\n\n\nFitting environmental data with ggplot could be a bit complex. First we need to manually apply those on our NMDS:\n\nen &lt;- envfit(tadNMDS, env.comp[, c(3:7, ncol(env.comp):ncol(env.comp))], permutation = 0, na.rm = T) # only fitting a subset of the data\nen\n\n\n***VECTORS\n\n                         NMDS1    NMDS2     r2\naltitude [m asl]      -0.80683  0.59078 0.1046\nstream slope [cm/30m]  0.76356  0.64574 0.5515\ntemperature [°C]      -0.25383  0.96725 0.1909\nWidth (m)             -0.92955 -0.36870 0.6336\nDepth (cm)            -0.95328 -0.30209 0.7877\nspecies_richness      -0.83828 -0.54524 0.7466\n\n5 Beobachtungen als fehlend gelöscht\n\n\nenvfit distinguishes the variables into vectors (continuous) or factor (categorical) variables. For each category (in each categorical variable), the centroid coordinates was calculated, which represents the center of the mass and the average coordination of all points belong to that category.\nThe five vector variables are self-explained, Speed_cat represents the proportion of fast stream inside the sampled transect in five categories, e.g. a transect in which 74% of itself has fast stream is put in the category [70,80).\n\nSpider plot\nThe centroids can be used to plot a spider plot:"
  },
  {
    "objectID": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html#acknowledgement",
    "href": "Posts/Research/Community_Ecology/1_NMDS_and_PERMANOVA.html#acknowledgement",
    "title": "Community Ecology 1 - NMDS, PERMDISP and PERMANOVA",
    "section": "Acknowledgement",
    "text": "Acknowledgement\nI hereby express my thanks to the codes and examples shared by\n\nDr. Jackie Zorz\nDr. Christopher Chizinski\nAllan Cameron\n\nfor helping me finish this post.\n\nIssues? Comments? Improvements? I’m happy to hear your opinions on this post and my website. Find my source code at github or contact me."
  }
]